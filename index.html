<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Medical Insurance Premium</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <style>
        .modal-open {
            overflow: hidden !important;
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #0B1120;
            /* Deep Dark Blue Base */
            color: #f8fafc;
            -webkit-tap-highlight-color: transparent;
            overflow-x: hidden;
            height: 100vh;
            /* Fixed height for full app feel */
        }

        /* Custom Scrollbar */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
            opacity: 0;
            transform: translateY(15px);
        }

        .fade-in-delayed {
            animation: fadeIn 0.5s cubic-bezier(0.16, 1, 0.3, 1) 0.1s forwards;
            opacity: 0;
            transform: translateY(15px);
        }

        .slide-up {
            animation: slideUp 0.4s ease-out forwards;
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideUp {
            from {
                transform: translateY(100%);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* PREMIUM ANIMATED BACKGROUND */
        .ambient-light {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
            background: #0B1120;
        }

        .orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.5;
            animation: float 20s infinite ease-in-out alternate;
        }

        .orb-1 {
            top: -10%;
            left: -10%;
            width: 60vw;
            height: 60vw;
            background: #1D375F;
            /* Secondary Blue */
            animation-delay: 0s;
        }

        .orb-2 {
            bottom: -10%;
            right: -10%;
            width: 70vw;
            height: 70vw;
            background: #B99A4F;
            /* Primary Gold */
            opacity: 0.2;
            animation-delay: -5s;
        }

        .orb-3 {
            top: 40%;
            left: 40%;
            width: 40vw;
            height: 40vw;
            background: #1D375F;
            opacity: 0.3;
            animation-delay: -10s;
        }

        @keyframes float {
            0% {
                transform: translate(0, 0) scale(1);
            }

            100% {
                transform: translate(30px, 50px) scale(1.1);
            }
        }

        /* Chat Bubbles */
        .chat-bubble {
            max-width: 90%;
            width: fit-content;
            padding: 14px 18px;
            border-radius: 20px;
            font-size: 0.95rem;
            line-height: 1.6;
            position: relative;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        @media (min-width: 768px) {
            .chat-bubble {
                max-width: 60%;
            }
        }

        .chat-user {
            background: linear-gradient(135deg, #B99A4F 0%, #8A7137 100%);
            /* Gold Gradient */
            color: white;
            border-bottom-right-radius: 4px;
            align-self: flex-end;
            margin-left: auto;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .chat-bot {
            background-color: rgba(255, 255, 255, 0.95);
            color: #1e293b;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-bottom-left-radius: 4px;
            align-self: flex-start;
        }

        /* SEAMLESS HEADER */
        .seamless-header {
            /* No border, subtle gradient fade only */
            background: linear-gradient(to bottom, rgba(11, 17, 32, 0.8) 0%, rgba(11, 17, 32, 0) 100%);
            backdrop-filter: blur(2px);
        }

        /* Input Container Gradient Mask */
        .input-container-glass {
            background: linear-gradient(to top, rgba(11, 17, 32, 1) 20%, rgba(11, 17, 32, 0.8) 80%, rgba(11, 17, 32, 0) 100%);
            backdrop-filter: blur(8px);
        }

        /* Typing Indicator */
        .typing-dot {
            animation: typing 1.4s infinite ease-in-out both;
            height: 6px;
            width: 6px;
            background-color: #94a3b8;
            border-radius: 50%;
            display: inline-block;
            margin: 0 2px;
        }

        .typing-dot:nth-child(1) {
            animation-delay: -0.32s;
        }

        .typing-dot:nth-child(2) {
            animation-delay: -0.16s;
        }

        @keyframes typing {

            0%,
            80%,
            100% {
                transform: scale(0);
            }

            40% {
                transform: scale(1);
            }
        }

        /* Gold Button Class */
        .btn-gold {
            background: linear-gradient(135deg, #B99A4F 0%, #967d40 100%);
            color: white;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px -3px rgba(185, 154, 79, 0.4);
        }

        .btn-gold:active {
            transform: scale(0.98);
        }

        .btn-gold:hover {
            filter: brightness(1.1);
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            50: '#FDFBF6',
                            100: '#F7F3E6',
                            200: '#EBE2C8',
                            300: '#DFD0AA',
                            400: '#D3BE8C',
                            500: '#B99A4F', // Primary Gold
                            600: '#A68842',
                            700: '#8A7137',
                            900: '#1D375F',
                        },
                        secondary: {
                            DEFAULT: '#1D375F', // Secondary Blue
                            light: '#2a4d82',
                            dark: '#0B1120'
                        }
                    },
                    boxShadow: {
                        'soft': '0 10px 40px -10px rgba(0, 0, 0, 0.2)',
                        'glow': '0 0 30px rgba(185, 154, 79, 0.4)'
                    }
                }
            }
        }
    </script>
</head>

<body class="h-screen w-full flex flex-col overflow-hidden">

    <div class="ambient-light">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
    </div>

    <header id="header"
        class="fixed top-0 left-0 right-0 h-20 seamless-header z-50 flex items-center justify-between px-6 md:px-12 transition-all duration-300">
        <div class="flex items-center gap-4">
            <button onclick="goBack()" id="backBtn"
                class="hidden p-2 -ml-2 rounded-full hover:bg-white/10 transition-colors text-slate-200">
                <i data-lucide="arrow-left" class="w-5 h-5 md:w-6 md:h-6"></i>
            </button>
            <div class="flex flex-col">
                <span id="pageTitle"
                    class="text-[10px] md:text-xs font-bold uppercase tracking-[0.2em] text-brand-500">Dashboard</span>
                <h1 class="text-sm md:text-lg font-bold text-white hidden md:block">Medical Insurance Portal</h1>
            </div>
        </div>
        <div class="flex items-center gap-4">
            <div class="hidden md:flex flex-col items-end mr-2">
                <span id="header-username" class="text-xs font-bold text-white">Guest</span>
                <span class="text-[10px] text-brand-300">Verified Member</span>
            </div>
            <button onclick="clearChatSession()"
                class="hidden md:flex items-center gap-2 p-2 px-3 rounded-full bg-slate-800 text-slate-300 hover:text-white hover:bg-slate-700 transition-all border border-slate-700/50 mr-2 text-xs font-bold uppercase tracking-wider title='Restart Chat'">
                <i data-lucide="refresh-cw" class="w-4 h-4"></i> Clear
            </button>
            <div
                class="w-10 h-10 rounded-full border-2 border-brand-500 p-[2px] shadow-lg shadow-brand-500/20 cursor-pointer hover:scale-105 transition-transform bg-slate-900/50">
                <div id="header-initials"
                    class="w-full h-full rounded-full bg-transparent flex items-center justify-center text-brand-400 text-xs font-bold">
                    G</div>
            </div>
            <button onclick="logout()"
                class="ml-2 p-2 rounded-full bg-white/10 text-white hover:bg-red-500 hover:text-white transition-all border border-white/10"
                title="Logout">
                <i data-lucide="log-out" class="w-5 h-5"></i>
            </button>
        </div>
    </header>

    <main class="flex-1 w-full max-w-[1920px] mx-auto pt-20 relative overflow-y-auto no-scrollbar">

        <section id="view-login" class="min-h-[calc(100vh-80px)] flex flex-col items-center justify-center p-6 fade-in">
            <div
                class="w-full max-w-md bg-white/95 backdrop-blur-sm p-8 md:p-12 rounded-[32px] shadow-2xl border border-white/20">
                <div class="text-center mb-10">
                    <div
                        class="w-20 h-20 bg-gradient-to-br from-brand-500 to-brand-600 rounded-3xl mx-auto flex items-center justify-center mb-6 shadow-glow transform rotate-3 hover:rotate-6 transition-transform duration-500">
                        <i data-lucide="shield-check" class="w-10 h-10 text-white fill-white/20"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-slate-900 tracking-tight">Welcome Back</h2>
                    <p class="text-xs uppercase tracking-widest text-slate-400 mt-3 font-semibold">Secure Access Portal
                    </p>
                </div>

                <div id="login-step-1" class="space-y-5">
                    <div class="space-y-2">
                        <label class="text-[10px] font-bold uppercase tracking-wider text-slate-500 ml-1">Email
                            Address</label>
                        <div class="relative group">
                            <i data-lucide="mail"
                                class="absolute left-4 top-4 w-5 h-5 text-slate-400 group-focus-within:text-brand-500 transition-colors"></i>
                            <input type="email" id="emailInput"
                                class="w-full pl-12 pr-4 py-3.5 bg-slate-50 border border-slate-200 rounded-2xl text-sm font-medium focus:outline-none focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 transition-all text-slate-800"
                                placeholder="name@company.com">
                        </div>
                    </div>
                    <button onclick="sendOTP()"
                        class="w-full btn-gold font-semibold py-4 rounded-2xl text-sm transition-all shadow-lg">
                        Continue Securely
                    </button>
                </div>

                <div id="login-step-2" class="hidden space-y-8">
                    <div
                        class="bg-emerald-50 text-emerald-700 px-4 py-3 rounded-2xl text-xs font-medium text-center border border-emerald-100 flex items-center justify-center gap-2">
                        <i data-lucide="check-circle" class="w-4 h-4"></i> OTP sent to your email
                    </div>

                    <div class="space-y-3 text-center">
                        <label class="text-[10px] font-bold uppercase tracking-wider text-slate-400">Enter Access
                            Code</label>
                        <input type="text" id="otpInput" maxlength="4"
                            class="w-full text-center tracking-[1em] py-4 bg-transparent border-b-2 border-slate-200 text-3xl font-bold text-slate-800 focus:outline-none focus:border-brand-500 transition-colors placeholder:text-slate-200 placeholder:tracking-normal"
                            placeholder="â€¢â€¢â€¢â€¢">
                        <p class="text-xs text-slate-400 mt-2">Use code: <span
                                class="font-mono text-slate-600 font-bold bg-slate-100 px-2 py-0.5 rounded">1234</span>
                        </p>
                    </div>

                    <button onclick="verifyOTP()"
                        class="w-full btn-gold font-semibold py-4 rounded-2xl text-sm transition-all shadow-lg">
                        Verify & Login
                    </button>
                    <button onclick="resetLogin()"
                        class="w-full text-slate-400 hover:text-slate-600 text-xs font-medium py-2 uppercase tracking-wide">Change
                        Email</button>
                </div>
            </div>
        </section>

        <section id="view-landing" class="hidden w-full max-w-7xl mx-auto p-6 md:p-10 lg:p-14 pb-32">
            <div class="mb-12 mt-4 fade-in">
                <h2 class="text-3xl md:text-4xl font-bold text-white tracking-tight">Overview</h2>
                <p class="text-xs font-semibold text-brand-400 uppercase tracking-widest mt-2">Manage your health &
                    insurance</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8 fade-in-delayed">
                <div onclick="startInsuranceFlow()"
                    class="lg:col-span-2 group relative bg-white p-8 md:p-10 rounded-[32px] shadow-soft hover:shadow-2xl hover:shadow-brand-500/20 transition-all duration-300 cursor-pointer overflow-hidden border border-white/20">
                    <div
                        class="absolute top-0 right-0 w-64 h-64 bg-brand-50 rounded-full -mr-20 -mt-20 transition-transform group-hover:scale-110">
                    </div>
                    <div
                        class="relative z-10 flex flex-col md:flex-row md:items-center justify-between h-full min-h-[160px]">
                        <div class="mb-6 md:mb-0">
                            <div
                                class="w-14 h-14 bg-brand-500 rounded-2xl flex items-center justify-center shadow-lg shadow-brand-200 text-white mb-6 group-hover:-translate-y-1 transition-transform">
                                <i data-lucide="plus" class="w-7 h-7"></i>
                            </div>
                            <h3 class="font-bold text-2xl text-slate-900 leading-tight">Get Medical Insurance</h3>
                            <p class="text-sm font-medium text-slate-400 mt-2 max-w-sm">Apply for a new policy in
                                minutes using AI assistance.</p>
                        </div>
                        <div
                            class="flex items-center gap-2 btn-gold font-bold text-sm px-6 py-3 rounded-full transition-colors">
                            Start Application <i data-lucide="arrow-right" class="w-4 h-4"></i>
                        </div>
                    </div>
                </div>

                <div onclick="showDetails()"
                    class="bg-white p-8 rounded-[32px] shadow-soft border border-white/20 hover:border-brand-300 transition-all cursor-pointer hover:-translate-y-1">
                    <div
                        class="w-12 h-12 bg-emerald-50 rounded-2xl flex items-center justify-center text-emerald-600 mb-6">
                        <i data-lucide="file-text" class="w-6 h-6"></i>
                    </div>
                    <h3 class="font-bold text-lg text-slate-800">My Portfolio</h3>
                    <p class="text-xs text-slate-400 mt-2 font-medium uppercase tracking-wide">View active policies</p>
                </div>

                <div onclick="openAskAI()"
                    class="bg-white p-8 rounded-[32px] shadow-soft border border-white/20 hover:border-brand-300 transition-all cursor-pointer hover:-translate-y-1">
                    <div
                        class="w-12 h-12 bg-indigo-50 rounded-2xl flex items-center justify-center text-indigo-600 mb-6">
                        <!-- <i data-lucide="sparkles" class="w-6 h-6"></i> -->
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                            <path fill-rule="evenodd"
                                d="M9 4.5a.75.75 0 0 1 .721.544l.813 2.846a3.75 3.75 0 0 0 2.576 2.576l2.846.813a.75.75 0 0 1 0 1.442l-2.846.813a3.75 3.75 0 0 0-2.576 2.576l-.813 2.846a.75.75 0 0 1-1.442 0l-.813-2.846a3.75 3.75 0 0 0-2.576-2.576l-2.846-.813a.75.75 0 0 1 0-1.442l2.846-.813A3.75 3.75 0 0 0 7.466 7.89l.813-2.846A.75.75 0 0 1 9 4.5ZM18 1.5a.75.75 0 0 1 .728.568l.258 1.036c.236.94.97 1.674 1.91 1.91l1.036.258a.75.75 0 0 1 0 1.456l-1.036.258c-.94.236-1.674.97-1.91 1.91l-.258 1.036a.75.75 0 0 1-1.456 0l-.258-1.036a2.625 2.625 0 0 0-1.91-1.91l-1.036-.258a.75.75 0 0 1 0-1.456l1.036-.258a2.625 2.625 0 0 0 1.91-1.91l.258-1.036A.75.75 0 0 1 18 1.5ZM16.5 15a.75.75 0 0 1 .712.513l.394 1.183c.15.447.5.799.948.948l1.183.395a.75.75 0 0 1 0 1.422l-1.183.395c-.447.15-.799.5-.948.948l-.395 1.183a.75.75 0 0 1-1.422 0l-.395-1.183a1.5 1.5 0 0 0-.948-.948l-1.183-.395a.75.75 0 0 1 0-1.422l1.183-.395c.447-.15.799-.5.948-.948l.395-1.183A.75.75 0 0 1 16.5 15Z"
                                clip-rule="evenodd" />
                        </svg>

                    </div>
                    <h3 class="font-bold text-lg text-slate-800">Ask AI</h3>
                    <p class="text-xs text-slate-400 mt-2 font-medium uppercase tracking-wide">24/7 Support Assistant
                    </p>
                </div>
            </div>

            <div class="mt-12 fade-in-delayed">
                <div
                    class="bg-amber-500/10 border border-amber-500/20 backdrop-blur-md rounded-2xl p-6 flex gap-4 items-center max-w-3xl">
                    <div class="bg-amber-500/20 p-2 rounded-full">
                        <i data-lucide="info" class="w-5 h-5 text-amber-400"></i>
                    </div>
                    <p class="text-sm text-amber-100 font-medium">
                        <strong>Policy Rule:</strong> Only one medical insurance policy can be active per Emirates ID at
                        any given time.
                    </p>
                </div>
            </div>
        </section>

        <section id="view-chat-interface" class="hidden flex flex-col bg-transparent relative"
            style="height: calc(100vh - 80px);">
            <div id="chat-stream"
                class="flex-1 overflow-y-auto p-4 md:p-8 space-y-6 max-w-4xl mx-auto w-full scroll-smooth no-scrollbar">
            </div>

            <div class="pt-6 pb-6 px-4 md:px-6 input-container-glass">
                <div class="max-w-3xl mx-auto w-full">
                    <div id="chat-options-container"
                        class="hidden mb-4 flex flex-wrap gap-2 justify-center md:justify-start">
                    </div>

                    <div
                        class="flex items-center gap-3 bg-white p-2 rounded-full border border-slate-200 focus-within:border-brand-500 focus-within:ring-4 focus-within:ring-brand-500/20 transition-all shadow-lg">
                        <button
                            class="p-3 rounded-full text-slate-400 hover:text-slate-600 hover:bg-slate-100 transition-colors">
                            <i data-lucide="mic" class="w-5 h-5"></i>
                        </button>
                        <input type="text" id="chatInput" placeholder="Type your response..."
                            class="flex-1 bg-transparent text-sm md:text-base text-slate-800 placeholder:text-slate-400 focus:outline-none px-2">
                        <button onclick="handleManualSend()"
                            class="p-3 btn-gold rounded-full shadow-lg shadow-brand-500/40 active:scale-95 transition-transform">
                            <i data-lucide="arrow-up" class="w-5 h-5"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- VIEW ASK AI CHAT -->
        <section id="view-ai-chat" class="hidden flex flex-col bg-transparent relative"
            style="height: calc(100vh - 80px);">
            <div id="ai-chat-stream"
                class="flex-1 overflow-y-auto p-4 md:p-8 space-y-6 max-w-4xl mx-auto w-full scroll-smooth no-scrollbar">
            </div>

            <div class="pt-6 pb-6 px-4 md:px-6 input-container-glass">
                <div class="max-w-3xl mx-auto w-full">
                    <div
                        class="flex items-center gap-3 bg-white p-2 rounded-full border border-slate-200 focus-within:border-brand-500 focus-within:ring-4 focus-within:ring-brand-500/10 transition-all shadow-lg">
                        <input type="text" id="aiChatInput"
                            class="flex-1 bg-transparent text-sm md:text-base text-slate-800 placeholder:text-slate-400 focus:outline-none px-6">
                        <button onclick="handleAiManualSend()"
                            class="p-3 btn-gold rounded-full shadow-lg shadow-brand-500/40 active:scale-95 transition-transform">
                            <i data-lucide="arrow-up" class="w-5 h-5"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <section id="view-review"
            class="hidden fixed inset-0 z-50 bg-secondary-dark/80 backdrop-blur-md flex items-center justify-center p-4 overflow-hidden">
            <div
                class="bg-white w-full max-w-2xl max-h-[90vh] rounded-[32px] shadow-2xl relative overflow-hidden animate-slide-up flex flex-col border border-white/20">
                <div class="p-6 md:p-8 border-b border-slate-100 flex justify-between items-center bg-slate-50/50">
                    <div>
                        <h3 id="review-modal-subtitle"
                            class="text-xs font-bold uppercase tracking-widest text-slate-500">Verification</h3>
                        <h2 id="review-modal-title" class="text-xl font-bold text-slate-900">Review Details</h2>
                    </div>
                    <span id="review-modal-badge"
                        class="px-3 py-1 bg-green-100 text-green-700 text-[10px] font-bold rounded-full uppercase tracking-wide border border-green-200">
                        Extracted from ID
                    </span>
                </div>

                <div class="p-6 md:p-8 space-y-6 flex-1 overflow-y-auto" id="review-form">
                </div>

                <div
                    class="p-6 md:p-8 border-t border-slate-100 bg-slate-50 flex flex-col md:flex-row gap-4 items-center">
                    <div id="review-modal-notice"
                        class="flex-1 text-xs text-orange-600 font-medium flex gap-2 items-center bg-orange-50 p-3 rounded-xl border border-orange-100 w-full md:w-auto">
                        <i data-lucide="alert-triangle" class="w-4 h-4 flex-none"></i>
                        Verify details match Emirates ID to avoid rejection.
                    </div>
                    <button id="review-modal-cancel" onclick="cancelReview()"
                        class="w-full md:w-auto px-8 py-4 bg-slate-100 text-slate-500 rounded-xl font-bold text-sm hover:bg-slate-200 transition-all">
                        Close
                    </button>
                    <button id="review-modal-confirm" onclick="confirmReview()"
                        class="w-full md:w-auto px-8 py-4 btn-gold rounded-xl font-bold text-sm shadow-xl">
                        Confirm & Return to Chat
                    </button>
                </div>
            </div>
        </section>

        <!-- VIEW POLICY DETAILS MODAL -->
        <section id="view-policy-details"
            class="hidden fixed inset-0 z-50 bg-secondary-dark/80 backdrop-blur-md flex items-center justify-center p-4 overflow-hidden">
            <div
                class="bg-white w-full max-w-2xl max-h-[90vh] rounded-[32px] shadow-2xl relative overflow-hidden animate-slide-up flex flex-col border border-white/20">
                <div class="p-6 md:p-8 border-b border-slate-100 flex justify-between items-center bg-slate-50/50">
                    <div>
                        <h3 class="text-xs font-bold uppercase tracking-widest text-slate-500"
                            id="policy-detail-subtitle">Policy Information</h3>
                        <h2 class="text-xl font-bold text-slate-900" id="policy-detail-title">User Details</h2>
                    </div>
                    <button onclick="closePolicyDetails()"
                        class="p-2 bg-slate-100 rounded-full hover:bg-slate-200 transition-colors">
                        <i data-lucide="x" class="w-5 h-5 text-slate-500"></i>
                    </button>
                </div>

                <div class="p-6 md:p-8 space-y-6 flex-1 overflow-y-auto" id="policy-detail-container">
                    <!-- Read-only fields injected here -->
                </div>

                <div class="p-6 md:p-8 border-t border-slate-100 bg-slate-50 flex justify-end">
                    <button onclick="closePolicyDetails()"
                        class="w-full md:w-auto px-8 py-4 bg-slate-200 text-slate-700 rounded-xl font-bold text-sm hover:bg-slate-300 transition-all">
                        Close
                    </button>
                </div>
            </div>
        </section>

        <section id="view-details" class="hidden w-full max-w-5xl mx-auto p-6 md:p-10">
            <div class="flex items-center justify-between mb-8 mt-4">
                <h2 class="text-xs font-bold text-brand-300 uppercase tracking-widest">Active Policies</h2>
            </div>

            <div id="policies-list" class="grid grid-cols-1 md:grid-cols-2 gap-6">
            </div>

            <div id="no-policies" class="hidden min-h-[50vh] flex flex-col items-center justify-center text-center">
                <div
                    class="w-20 h-20 bg-white/10 backdrop-blur rounded-[2rem] flex items-center justify-center mb-6 rotate-12 border border-white/10">
                    <i data-lucide="file-minus" class="w-10 h-10 text-slate-400"></i>
                </div>
                <h3 class="text-lg font-bold text-white">No active insurance</h3>
                <p class="text-sm text-slate-400 mt-2 max-w-xs mx-auto">You haven't purchased any medical insurance
                    policies yet.</p>
                <button onclick="startInsuranceFlow()"
                    class="mt-8 px-8 py-4 btn-gold text-white rounded-xl text-xs font-bold uppercase tracking-widest shadow-lg">Get
                    Started</button>
            </div>
        </section>

    </main>

    <!-- GUIDELINES MODAL -->
    <div id="modal-guidelines"
        class="hidden fixed inset-0 z-[60] bg-secondary-dark/90 backdrop-blur-md flex items-center justify-center p-4">
        <div class="bg-white w-full max-w-md rounded-[32px] p-8 shadow-2xl relative overflow-hidden animate-slide-up">
            <div class="absolute top-0 left-0 w-full h-2 bg-brand-500"></div>
            <div class="flex justify-between items-center mb-8">
                <h3 class="text-xs font-bold uppercase tracking-widest text-slate-900">Before We Start</h3>
                <button onclick="closeGuidelines()"
                    class="p-2 bg-slate-50 rounded-full hover:bg-slate-100 transition-colors">
                    <i data-lucide="x" class="w-5 h-5 text-slate-500"></i>
                </button>
            </div>

            <div
                class="bg-blue-50 border border-blue-100 text-blue-900 text-sm p-6 rounded-2xl mb-6 leading-relaxed font-medium shadow-sm">
                "Please complete the medical insurance process once you start it. Leaving midway will cancel the
                application."
            </div>

            <div
                class="flex items-center gap-4 text-xs font-semibold text-slate-500 mb-10 bg-slate-50 p-4 rounded-xl border border-slate-100">
                <div class="p-2 bg-white rounded-lg shadow-sm">
                    <i data-lucide="credit-card" class="w-5 h-5 text-slate-400"></i>
                </div>
                Please have your Emirates ID ready for scanning.
            </div>

            <button onclick="closeGuidelines()"
                class="w-full btn-gold text-white py-4 rounded-2xl text-sm font-bold shadow-lg">
                I Understand, Let's Go
            </button>
        </div>
    </div>

    <!-- CUSTOM ALERT MODAL -->
    <div id="modal-alert"
        class="hidden fixed inset-0 z-[100] bg-secondary-dark/90 backdrop-blur-md flex items-center justify-center p-4">
        <div class="bg-white w-full max-w-sm rounded-[32px] p-8 shadow-2xl relative overflow-hidden animate-slide-up">
            <div id="alert-accent" class="absolute top-0 left-0 w-full h-2 bg-brand-500"></div>

            <div class="flex flex-col items-center text-center">
                <div id="alert-icon-container"
                    class="w-16 h-16 rounded-2xl flex items-center justify-center mb-6 shadow-soft">
                    <i id="alert-icon" data-lucide="info" class="w-8 h-8"></i>
                </div>

                <h3 id="alert-title" class="text-xl font-bold text-slate-900 mb-2">Notification</h3>
                <p id="alert-message" class="text-sm text-slate-500 leading-relaxed font-medium mb-8">This is a custom
                    message.</p>

                <div class="flex gap-3 w-full" id="alert-buttons">
                    <button id="alert-btn-cancel"
                        class="hidden flex-1 px-6 py-3.5 bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-2xl text-xs font-bold uppercase tracking-wider transition-all">
                        Cancel
                    </button>
                    <button id="alert-btn-confirm"
                        class="flex-1 px-6 py-3.5 btn-gold text-white rounded-2xl text-xs font-bold uppercase tracking-wider shadow-lg">
                        Okay
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- ICONS ---
        lucide.createIcons();

        // --- API CONFIG ---
        const API_BASE = 'http://127.0.0.1:8000/api';
        // const API_BASE = 'https://api.keralahome.in/api';


        // --- TRANSLATIONS ---
        const translations = {
            en: {
                welcome: "Hi! Welcome to the Insurance Assistant ğŸ‘‹",
                select_lang: "Please choose the language youâ€™re most comfortable with.",
                looking_for_insurance: "Are you looking to get Medical Insurance today?",
                yes_start: "Yes, letâ€™s start",
                no_cancel: "No, maybe later",
                cancel_msg: "No worries! Just let us know whenever you need help ğŸ˜Š",
                employee_or_dependent: "To get started, please tell us â€” are you an Employee or a Dependent?",
                employee: "Employee",
                dependent: "Dependent",
                income_self: "What is your monthly income?",
                income_sponsor: "What is your sponsorâ€™s monthly income?",
                dependent_type_q: "Please select the type of dependent you are.",
                spouse: "Spouse",
                child: "Child",
                upload_self: "Please upload your valid Emirates ID to continue.",
                upload_sponsor: "Please upload your Sponsorâ€™s Emirates ID to continue.",
                btn_upload: "Scan or Upload Emirates ID",
                uploading: "Uploading your IDâ€¦ please wait.",
                review_details: "Please review your details carefully before proceeding.",
                verified_details: "Verified Details",
                name: "Full Name",
                eid: "Emirates ID",
                dob: "Date of Birth",
                nationality: "Nationality",
                gender: "Gender",
                issuing_date: "Issuing Date",
                expiry_date: "Expiry Date",
                issuing_place: "Issuing Place",
                occupation: "Occupation",
                sponsor: "Sponsor",
                mobile: "Mobile Number",
                salary_range_label: "Salary Range",
                found_plans: (n) => `Good news! I found ${n} eligible plan(s) for you. Please choose one to continue.`,
                no_plans: "Sorry! Based on your salary range and issuing place, there are no eligible online plans available right now.",
                eligible: "Eligible",
                select_plan_msg: (name, type) => `Iâ€™d like to proceed with the ${name} (${type}) plan.`,
                success_title: "Success ğŸ‰",
                policy_active: "Your policy is now active",
                policy_no: "Policy Number",
                premium: "Premium Amount",
                continue_btn: "Continue",
                welcome_back: "Welcome back! Iâ€™ve restored your previous session for you.",
                continue_income: "Letâ€™s continue from where you left off. Please select your income range.",
                restart_prompt: "Please use the options above to continue your application.",
                below_4000: "Below 4000 AED",
                between_4000_5000: "4000 â€“ 5000 AED",
                above_5000: "Above 5000 AED",
                reset_failed: "Oops! We couldnâ€™t reset the session. Please try again.",
                start_fresh_q: "Start fresh?",
                start_fresh_msg: "This will clear your current progress and restart the application.",
                upload_failed: "We couldnâ€™t process the document. Please try again.",
                upload_error: "Something went wrong while uploading the document.",
                return_dashboard: "Return to Dashboard",
                verifying: "Verifying your detailsâ€¦",
                sending: "Sendingâ€¦",
                connection_error_title: "Connection Issue",
                connection_error_msg: "Please check your internet connection and try again.",
                logout_q: "Log out",
                logout_msg: "Are you sure you want to log out?",
                exit_session_q: "Exit session?",
                exit_session_msg: "If you exit now, your progress may be lost.",
                login_failed_title: "Login Failed",
                req_missing: "Some required information is missing",
                enter_otp: "Please enter the verification code sent to you",
                expired_doc_title: "Document Expired",
                expired_doc_msg: "Your Emirates ID has expired. We canâ€™t continue with the process.",
                missing_info: "Missing Information",
                enter_mobile: "Please enter a valid mobile number.",
                review_details_title: "Review Your Details",
                eid_no: "Emirates ID Number",
                verification_title: "Verification",
                extracted_label: "Extracted from Emirates ID",
                verify_notice: "Please make sure the details match your Emirates ID to avoid rejection.",
                confirm_btn: "Confirm and Continue",
                male: "Male",
                female: "Female",
                mobile_number_label: "Mobile Number",
                policy_info_label: "Policy Details",
                user_details_label: "Your Details",
                close_btn: "Close",
                ai_placeholder: "Ask anything about insurance...",
                ai_welcome_msg: "Hello! I'm your insurance assistant. Ask me about coverage, company details, or support.",
                ai_thinking: "Gia is thinking..."
            },
            ml: {
                welcome: "à´‡àµ»à´·àµà´±àµ»à´¸àµ à´…à´¸à´¿à´¸àµà´±àµà´±à´¨àµà´±à´¿à´²àµ‡à´•àµà´•àµ à´¸àµà´µà´¾à´—à´¤à´‚ ğŸ‘‹",
                select_lang: "à´¨à´¿à´™àµà´™àµ¾à´•àµà´•àµ à´à´³àµà´ªàµà´ªà´®àµà´³àµà´³ à´­à´¾à´· à´¤à´¿à´°à´àµà´àµ†à´Ÿàµà´•àµà´•àµ‚.",
                looking_for_insurance: "à´¨à´¿à´™àµà´™àµ¾ à´®àµ†à´¡à´¿à´•àµà´•àµ½ à´‡àµ»à´·àµà´±àµ»à´¸àµ à´à´Ÿàµà´•àµà´•à´¾àµ» à´†à´—àµà´°à´¹à´¿à´•àµà´•àµà´¨àµà´¨àµà´£àµà´Ÿàµ‹?",
                yes_start: "à´…à´¤àµ†, à´¤àµà´Ÿà´™àµà´™à´¾à´‚",
                no_cancel: "à´µàµ‡à´£àµà´Ÿ, à´ªà´¿à´¨àµà´¨àµ€à´Ÿàµ",
                cancel_msg: "à´¶à´°à´¿ ğŸ™‚ à´¨à´¿à´™àµà´™àµ¾à´•àµà´•àµ à´†à´µà´¶àµà´¯à´®àµà´£àµà´Ÿà´¾à´•àµà´®àµà´ªàµ‹àµ¾ à´à´™àµà´™à´³àµ† à´…à´±à´¿à´¯à´¿à´•àµà´•àµ‚.",
                employee_or_dependent: "à´†à´°à´‚à´­à´¿à´•àµà´•à´¾àµ», à´¦à´¯à´µà´¾à´¯à´¿ à´ªà´±à´¯àµ‚ â€” à´¨à´¿à´™àµà´™àµ¾ Employee à´†à´£àµ‹ Dependent à´†à´£àµ‹?",
                employee: "Employee (à´œàµ‹à´²à´¿à´•àµà´•à´¾à´°àµ»)",
                dependent: "Dependent (à´†à´¶àµà´°à´¿à´¤àµ»)",
                income_self: "à´¨à´¿à´™àµà´™à´³àµà´Ÿàµ† à´ªàµà´°à´¤à´¿à´®à´¾à´¸ à´µà´°àµà´®à´¾à´¨à´‚ à´à´¤àµà´°à´¯à´¾à´£àµ?",
                income_sponsor: "à´¨à´¿à´™àµà´™à´³àµà´Ÿàµ† à´¸àµà´ªàµ‹àµºà´¸à´±àµà´Ÿàµ† à´ªàµà´°à´¤à´¿à´®à´¾à´¸ à´µà´°àµà´®à´¾à´¨à´‚ à´à´¤àµà´°à´¯à´¾à´£àµ?",
                dependent_type_q: "à´¨à´¿à´™àµà´™àµ¾ à´à´¤àµ à´¤à´°à´¤àµà´¤à´¿à´²àµà´³àµà´³ à´†à´¶àµà´°à´¿à´¤à´¨à´¾à´£àµ?",
                spouse: "à´­à´¾à´°àµà´¯ / à´­àµ¼à´¤àµà´¤à´¾à´µàµ",
                child: "à´•àµà´Ÿàµà´Ÿà´¿",
                upload_self: "à´¤àµà´Ÿà´°à´¾àµ», à´¦à´¯à´µà´¾à´¯à´¿ à´¨à´¿à´™àµà´™à´³àµà´Ÿàµ† Emirates ID à´…à´ªàµâ€Œà´²àµ‹à´¡àµ à´šàµ†à´¯àµà´¯àµ‚.",
                upload_sponsor: "à´¤àµà´Ÿà´°à´¾àµ», à´¦à´¯à´µà´¾à´¯à´¿ à´¸àµà´ªàµ‹àµºà´¸à´±àµà´Ÿàµ† Emirates ID à´…à´ªàµâ€Œà´²àµ‹à´¡àµ à´šàµ†à´¯àµà´¯àµ‚.",
                btn_upload: "à´¸àµà´•à´¾àµ» à´šàµ†à´¯àµà´¯àµà´• / ID à´…à´ªàµâ€Œà´²àµ‹à´¡àµ à´šàµ†à´¯àµà´¯àµà´•",
                uploading: "ID à´…à´ªàµâ€Œà´²àµ‹à´¡àµ à´šàµ†à´¯àµà´¯àµà´¨àµà´¨àµâ€¦ à´¦à´¯à´µà´¾à´¯à´¿ à´•à´¾à´¤àµà´¤à´¿à´°à´¿à´•àµà´•àµà´•.",
                review_details: "à´¤àµà´Ÿà´°àµà´¨àµà´¨à´¤à´¿à´¨àµ à´®àµà´®àµà´ªàµ à´¨à´¿à´™àµà´™à´³àµà´Ÿàµ† à´µà´¿à´µà´°à´™àµà´™àµ¾ à´ªà´°à´¿à´¶àµ‹à´§à´¿à´•àµà´•àµ‚.",
                verified_details: "à´¸àµà´¥à´¿à´°àµ€à´•à´°à´¿à´šàµà´š à´µà´¿à´µà´°à´™àµà´™àµ¾",
                name: "à´®àµà´´àµà´µàµ» à´ªàµ‡à´°àµ",
                eid: "Emirates ID",
                dob: "à´œà´¨à´¨ à´¤àµ€à´¯à´¤à´¿",
                nationality: "à´¦àµ‡à´¶àµ€à´¯à´¤",
                gender: "à´²à´¿à´‚à´—à´‚",
                issuing_date: "à´‡à´·àµà´¯àµ‚ à´šàµ†à´¯àµà´¤ à´¤àµ€à´¯à´¤à´¿",
                expiry_date: "à´•à´¾à´²à´¹à´°à´£à´ªàµà´ªàµ†à´Ÿàµà´¨àµà´¨ à´¤àµ€à´¯à´¤à´¿",
                issuing_place: "à´‡à´·àµà´¯àµ‚ à´šàµ†à´¯àµà´¤ à´¸àµà´¥à´²à´‚",
                occupation: "à´¤àµŠà´´à´¿àµ½",
                sponsor: "à´¸àµà´ªàµ‹àµºà´¸àµ¼",
                mobile: "à´®àµŠà´¬àµˆàµ½ à´¨à´®àµà´ªàµ¼",
                salary_range_label: "à´µà´°àµà´®à´¾à´¨ à´ªà´°à´¿à´§à´¿",
                found_plans: (n) => `à´¸à´¨àµà´¤àµ‹à´·à´µà´¾àµ¼à´¤àµà´¤! à´¨à´¿à´™àµà´™àµ¾à´•àµà´•àµ à´…à´¨àµà´¯àµ‹à´œàµà´¯à´®à´¾à´¯ ${n} à´ªàµà´²à´¾àµ»(à´•àµ¾) à´•à´£àµà´Ÿàµ†à´¤àµà´¤à´¿à´¯à´¿à´Ÿàµà´Ÿàµà´£àµà´Ÿàµ. à´’à´¨àµà´¨àµ à´¤à´¿à´°à´àµà´àµ†à´Ÿàµà´•àµà´•àµ‚.`,
                no_plans: "à´•àµà´·à´®à´¿à´•àµà´•à´£à´‚. à´¨à´¿à´™àµà´™à´³àµà´Ÿàµ† à´µà´°àµà´®à´¾à´¨à´µàµà´‚ à´‡à´·àµà´¯àµ‚ à´šàµ†à´¯àµà´¤ à´¸àµà´¥à´²à´µàµà´‚ à´…à´Ÿà´¿à´¸àµà´¥à´¾à´¨à´®à´¾à´•àµà´•à´¿ à´‡à´ªàµà´ªàµ‹àµ¾ à´ªàµà´²à´¾à´¨àµà´•àµ¾ à´²à´­àµà´¯à´®à´²àµà´².",
                eligible: "à´¯àµ‹à´—àµà´¯à´®à´¾à´£àµ",
                select_plan_msg: (name, type) => `à´à´¾àµ» ${name} (${type}) à´ªàµà´²à´¾àµ» à´à´Ÿàµà´•àµà´•à´¾à´‚.`,
                success_title: "à´µà´¿à´œà´¯à´‚ ğŸ‰",
                policy_active: "à´¨à´¿à´™àµà´™à´³àµà´Ÿàµ† à´ªàµ‹à´³à´¿à´¸à´¿ à´¸à´œàµ€à´µà´®à´¾à´¯à´¿",
                policy_no: "à´ªàµ‹à´³à´¿à´¸à´¿ à´¨à´®àµà´ªàµ¼",
                premium: "à´ªàµà´°àµ€à´®à´¿à´¯à´‚",
                continue_btn: "à´¤àµà´Ÿà´°àµà´•",
                welcome_back: "à´µàµ€à´£àµà´Ÿàµà´‚ à´¸àµà´µà´¾à´—à´¤à´‚! à´¨à´¿à´™àµà´™à´³àµà´Ÿàµ† à´®àµàµ» à´¸àµ†à´·àµ» à´ªàµà´¨à´ƒà´¸àµà´¥à´¾à´ªà´¿à´šàµà´šà´¿à´Ÿàµà´Ÿàµà´£àµà´Ÿàµ.",
                continue_income: "à´¨à´®àµà´•àµà´•àµ à´¤àµà´Ÿà´°à´¾à´‚. à´¦à´¯à´µà´¾à´¯à´¿ à´µà´°àµà´®à´¾à´¨ à´ªà´°à´¿à´§à´¿ à´¤à´¿à´°à´àµà´àµ†à´Ÿàµà´•àµà´•àµ‚.",
                restart_prompt: "à´®àµà´•à´³à´¿àµ½ à´¨àµ½à´•à´¿à´¯à´¿à´°à´¿à´•àµà´•àµà´¨àµà´¨ à´“à´ªàµà´·à´¨àµà´•àµ¾ à´‰à´ªà´¯àµ‹à´—à´¿à´šàµà´šàµ à´¤àµà´Ÿà´°àµ‚.",
                below_4000: "4000 AED-àµ½ à´¤à´¾à´´àµ†",
                between_4000_5000: "4000 â€“ 5000 AED",
                above_5000: "5000 AED-à´•àµà´•àµ à´®àµà´•à´³à´¿àµ½",
                reset_failed: "à´¸àµ†à´·àµ» à´±àµ€à´¸àµ†à´±àµà´±àµ à´šàµ†à´¯àµà´¯à´¾àµ» à´•à´´à´¿à´àµà´à´¿à´²àµà´². à´µàµ€à´£àµà´Ÿàµà´‚ à´¶àµà´°à´®à´¿à´•àµà´•àµ‚.",
                start_fresh_q: "à´ªàµà´¤àµà´¤à´¾à´¯à´¿ à´¤àµà´Ÿà´™àµà´™à´£àµ‹?",
                start_fresh_msg: "à´‡à´¤àµ à´¨à´¿à´²à´µà´¿à´²àµ† à´ªàµà´°àµ‹à´—à´¤à´¿ à´®à´¾à´¯àµà´šàµà´šàµ à´µàµ€à´£àµà´Ÿàµà´‚ à´¤àµà´Ÿà´™àµà´™àµà´‚.",
                upload_failed: "à´°àµ‡à´– à´ªàµà´°àµ‹à´¸à´¸àµ à´šàµ†à´¯àµà´¯à´¾àµ» à´•à´´à´¿à´àµà´à´¿à´²àµà´². à´µàµ€à´£àµà´Ÿàµà´‚ à´¶àµà´°à´®à´¿à´•àµà´•àµ‚.",
                upload_error: "à´°àµ‡à´– à´…à´ªàµâ€Œà´²àµ‹à´¡àµ à´šàµ†à´¯àµà´¯àµà´®àµà´ªàµ‹àµ¾ à´ªà´¿à´¶à´•àµ à´¸à´‚à´­à´µà´¿à´šàµà´šàµ.",
                return_dashboard: "à´¡à´¾à´·àµâ€Œà´¬àµ‹àµ¼à´¡à´¿à´²àµ‡à´•àµà´•àµ à´®à´Ÿà´™àµà´™àµà´•",
                verifying: "à´µà´¿à´µà´°à´™àµà´™àµ¾ à´ªà´°à´¿à´¶àµ‹à´§à´¿à´•àµà´•àµà´¨àµà´¨àµâ€¦",
                sending: "à´…à´¯à´•àµà´•àµà´¨àµà´¨àµâ€¦",
                connection_error_title: "à´•à´£à´•àµà´·àµ» à´ªàµà´°à´¶àµà´¨à´‚",
                connection_error_msg: "à´‡à´¨àµà´±àµ¼à´¨àµ†à´±àµà´±àµ à´•à´£à´•àµà´·àµ» à´ªà´°à´¿à´¶àµ‹à´§à´¿à´šàµà´šàµ à´µàµ€à´£àµà´Ÿàµà´‚ à´¶àµà´°à´®à´¿à´•àµà´•àµ‚.",
                logout_q: "à´²àµ‹à´—àµ à´”à´Ÿàµà´Ÿàµ à´šàµ†à´¯àµà´¯à´£àµ‹?",
                logout_msg: "à´¨à´¿à´™àµà´™àµ¾à´•àµà´•àµ à´²àµ‹à´—àµ à´”à´Ÿàµà´Ÿàµ à´šàµ†à´¯àµà´¯à´£à´®àµ†à´¨àµà´¨àµ à´‰à´±à´ªàµà´ªà´¾à´£àµ‹?",
                exit_session_q: "à´¸àµ†à´·àµ» à´…à´µà´¸à´¾à´¨à´¿à´ªàµà´ªà´¿à´•àµà´•à´£àµ‹?",
                exit_session_msg: "à´‡à´ªàµà´ªàµ‹àµ¾ à´ªàµà´±à´¤àµà´¤àµà´ªàµ‹à´¯à´¾àµ½ à´ªàµà´°àµ‹à´—à´¤à´¿ à´¨à´·àµà´Ÿà´ªàµà´ªàµ†à´Ÿà´¾à´‚.",
                login_failed_title: "à´²àµ‹à´—à´¿àµ» à´ªà´°à´¾à´œà´¯à´ªàµà´ªàµ†à´Ÿàµà´Ÿàµ",
                req_missing: "à´†à´µà´¶àµà´¯à´®à´¾à´¯ à´µà´¿à´µà´°à´™àµà´™àµ¾ à´²à´­àµà´¯à´®à´²àµà´²",
                enter_otp: "à´¨à´¿à´™àµà´™àµ¾à´•àµà´•àµ à´²à´­à´¿à´šàµà´š à´µàµ†à´°à´¿à´«à´¿à´•àµà´•àµ‡à´·àµ» à´•àµ‹à´¡àµ à´¨àµ½à´•àµ‚",
                expired_doc_title: "à´°àµ‡à´–à´¯àµà´Ÿàµ† à´•à´¾à´²à´¾à´µà´§à´¿ à´•à´´à´¿à´àµà´àµ",
                expired_doc_msg: "Emirates ID à´•à´¾à´²à´¹à´°à´£à´ªàµà´ªàµ†à´Ÿàµà´Ÿàµ. à´ªàµà´°à´•àµà´°à´¿à´¯ à´¤àµà´Ÿà´°à´¾àµ» à´•à´´à´¿à´¯à´¿à´²àµà´².",
                missing_info: "à´µà´¿à´µà´°à´™àµà´™àµ¾ à´…à´ªàµ‚àµ¼à´£àµà´£à´®à´¾à´£àµ",
                enter_mobile: "à´¦à´¯à´µà´¾à´¯à´¿ à´¸à´¾à´§àµà´µà´¾à´¯ à´®àµŠà´¬àµˆàµ½ à´¨à´®àµà´ªàµ¼ à´¨àµ½à´•àµ‚.",
                review_details_title: "à´µà´¿à´µà´°à´™àµà´™àµ¾ à´ªà´°à´¿à´¶àµ‹à´§à´¿à´•àµà´•àµà´•",
                eid_no: "Emirates ID à´¨à´®àµà´ªàµ¼",
                verification_title: "à´¸àµà´¥à´¿à´°àµ€à´•à´°à´£à´‚",
                extracted_label: "ID-à´¯à´¿àµ½ à´¨à´¿à´¨àµà´¨àµ à´à´Ÿàµà´¤àµà´¤ à´µà´¿à´µà´°à´™àµà´™àµ¾",
                verify_notice: "à´±à´¿à´œà´•àµà´·àµ» à´’à´´à´¿à´µà´¾à´•àµà´•à´¾àµ» à´µà´¿à´µà´°à´™àµà´™àµ¾ ID-à´¯àµà´®à´¾à´¯à´¿ à´ªàµŠà´°àµà´¤àµà´¤à´ªàµà´ªàµ†à´Ÿàµà´¨àµà´¨àµà´µàµ†à´¨àµà´¨àµ à´‰à´±à´ªàµà´ªà´¾à´•àµà´•àµ‚.",
                confirm_btn: "à´¸àµà´¥à´¿à´°àµ€à´•à´°à´¿à´šàµà´šàµ à´¤àµà´Ÿà´°àµà´•",
                male: "à´ªàµà´°àµà´·àµ»",
                female: "à´¸àµà´¤àµà´°àµ€",
                mobile_number_label: "à´®àµŠà´¬àµˆàµ½ à´¨à´®àµà´ªàµ¼",
                policy_info_label: "à´ªàµ‹à´³à´¿à´¸à´¿ à´µà´¿à´µà´°à´™àµà´™àµ¾",
                user_details_label: "à´¨à´¿à´™àµà´™à´³àµà´Ÿàµ† à´µà´¿à´µà´°à´™àµà´™àµ¾",
                close_btn: "à´…à´Ÿà´¯àµà´•àµà´•àµà´•",
                ai_placeholder: "à´‡àµ»à´·àµà´±àµ»à´¸à´¿à´¨àµ†à´•àµà´•àµà´±à´¿à´šàµà´šàµ à´à´¨àµà´¤àµà´‚ à´šàµ‹à´¦à´¿à´•àµà´•àµ‚...",
                ai_welcome_msg: "à´¹à´²àµ‹! à´à´¾àµ» à´¨à´¿à´™àµà´™à´³àµà´Ÿàµ† à´‡àµ»à´·àµà´±àµ»à´¸àµ à´…à´¸à´¿à´¸àµà´±àµà´±à´¨àµà´±à´¾à´£àµ. à´•à´µà´±àµ‡à´œàµ, à´•à´®àµà´ªà´¨à´¿ à´µà´¿à´µà´°à´™àµà´™àµ¾ à´…à´²àµà´²àµ†à´™àµà´•à´¿àµ½ à´¸à´ªàµà´ªàµ‹àµ¼à´Ÿàµà´Ÿàµ à´à´¨àµà´¨à´¿à´µà´¯àµ†à´•àµà´•àµà´±à´¿à´šàµà´šàµ à´à´¨àµà´¨àµ‹à´Ÿàµ à´šàµ‹à´¦à´¿à´•àµà´•à´¾à´‚.",
                ai_thinking: "à´œà´¿à´¯ à´šà´¿à´¨àµà´¤à´¿à´•àµà´•àµà´¨àµà´¨àµ..."
            },
            ar: {
                welcome: "Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ğŸ‘‹ ÙÙŠ Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„ØªØ£Ù…ÙŠÙ†",
                select_lang: "ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù„ØºØ© Ø§Ù„ØªÙŠ ØªÙØ¶Ù„Ù‡Ø§.",
                looking_for_insurance: "Ù‡Ù„ ØªØ±ØºØ¨ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªØ£Ù…ÙŠÙ† Ø·Ø¨ÙŠ Ø§Ù„ÙŠÙˆÙ…ØŸ",
                yes_start: "Ù†Ø¹Ù…ØŒ Ù„Ù†Ø¨Ø¯Ø£",
                no_cancel: "Ù„Ø§ØŒ Ù„Ø§Ø­Ù‚Ù‹Ø§",
                cancel_msg: "Ù„Ø§ Ù…Ø´ÙƒÙ„Ø© ğŸ˜Š Ø£Ø®Ø¨Ø±Ù†Ø§ Ù…ØªÙ‰ Ù…Ø§ Ø§Ø­ØªØ¬Øª Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©.",
                employee_or_dependent: "Ù„Ù„Ø¨Ø¯Ø¡ØŒ Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø®Ø¨Ø±Ù†Ø§ â€” Ù‡Ù„ Ø£Ù†Øª Ù…ÙˆØ¸Ù Ø£Ù… ØªØ§Ø¨Ø¹ØŸ",
                employee: "Ù…ÙˆØ¸Ù",
                dependent: "ØªØ§Ø¨Ø¹",
                income_self: "Ù…Ø§ Ù‡Ùˆ Ø¯Ø®Ù„Ùƒ Ø§Ù„Ø´Ù‡Ø±ÙŠØŸ",
                income_sponsor: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¯Ø®Ù„ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„ÙƒÙÙŠÙ„ØŸ",
                dependent_type_q: "Ù…Ø§ Ù†ÙˆØ¹ Ø§Ù„ØªØ§Ø¨Ø¹ Ø§Ù„Ø°ÙŠ Ø£Ù†Øª Ø¹Ù„ÙŠÙ‡ØŸ",
                spouse: "Ø²ÙˆØ¬ / Ø²ÙˆØ¬Ø©",
                child: "Ø·ÙÙ„",
                upload_self: "Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©ØŒ ÙŠØ±Ø¬Ù‰ ØªØ­Ù…ÙŠÙ„ Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø¥Ù…Ø§Ø±Ø§ØªÙŠØ© Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ.",
                upload_sponsor: "Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©ØŒ ÙŠØ±Ø¬Ù‰ ØªØ­Ù…ÙŠÙ„ Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø¥Ù…Ø§Ø±Ø§ØªÙŠØ© Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„ÙƒÙÙŠÙ„.",
                btn_upload: "Ù…Ø³Ø­ Ø£Ùˆ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‡ÙˆÙŠØ©",
                uploading: "Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‡ÙˆÙŠØ©â€¦ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±.",
                review_details: "ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø¨Ø¹Ù†Ø§ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©.",
                verified_details: "Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¤ÙƒØ¯Ø©",
                name: "Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„",
                eid: "Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø¥Ù…Ø§Ø±Ø§ØªÙŠØ©",
                dob: "ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯",
                nationality: "Ø§Ù„Ø¬Ù†Ø³ÙŠØ©",
                gender: "Ø§Ù„Ø¬Ù†Ø³",
                issuing_date: "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±",
                expiry_date: "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡",
                issuing_place: "Ù…ÙƒØ§Ù† Ø§Ù„Ø¥ØµØ¯Ø§Ø±",
                occupation: "Ø§Ù„Ù…Ù‡Ù†Ø©",
                sponsor: "Ø§Ù„ÙƒÙÙŠÙ„",
                mobile: "Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ù…ØªØ­Ø±Ùƒ",
                salary_range_label: "Ù†Ø·Ø§Ù‚ Ø§Ù„Ø±Ø§ØªØ¨",
                found_plans: (n) => `Ø®Ø¨Ø± Ø³Ø§Ø±! ÙˆØ¬Ø¯Ù†Ø§ ${n} Ø®Ø·Ø© Ù…Ø¤Ù‡Ù„Ø© Ù„Ùƒ. ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¥Ø­Ø¯Ø§Ù‡Ø§ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©.`,
                no_plans: "Ù†Ø¹ØªØ°Ø±ØŒ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø§ØªØ¨ ÙˆÙ…ÙƒØ§Ù† Ø§Ù„Ø¥ØµØ¯Ø§Ø±ØŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø®Ø·Ø· Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠÙ‹Ø§.",
                eligible: "Ù…Ø¤Ù‡Ù„",
                select_plan_msg: (name, type) => `Ø£Ø±ØºØ¨ ÙÙŠ Ø§Ø®ØªÙŠØ§Ø± Ø®Ø·Ø© ${name} (${type}).`,
                success_title: "ØªÙ… Ø¨Ù†Ø¬Ø§Ø­ ğŸ‰",
                policy_active: "ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨ÙˆÙ„ÙŠØµØ© Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ",
                policy_no: "Ø±Ù‚Ù… Ø§Ù„Ø¨ÙˆÙ„ÙŠØµØ©",
                premium: "Ù‚ÙŠÙ…Ø© Ø§Ù„Ù‚Ø³Ø·",
                continue_btn: "Ù…ØªØ§Ø¨Ø¹Ø©",
                welcome_back: "Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ø¹ÙˆØ¯ØªÙƒ! Ù„Ù‚Ø¯ Ù‚Ù…Ù†Ø§ Ø¨Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø¬Ù„Ø³ØªÙƒ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©.",
                continue_income: "Ù„Ù†ÙÙƒÙ…Ù„ Ù…Ù† Ø­ÙŠØ« ØªÙˆÙ‚ÙØª. ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¯Ø®Ù„.",
                restart_prompt: "ÙŠØ±Ø¬Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø£Ø¹Ù„Ø§Ù‡ Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨.",
                below_4000: "Ø£Ù‚Ù„ Ù…Ù† 4000 Ø¯Ø±Ù‡Ù…",
                between_4000_5000: "4000 â€“ 5000 Ø¯Ø±Ù‡Ù…",
                above_5000: "Ø£ÙƒØ«Ø± Ù…Ù† 5000 Ø¯Ø±Ù‡Ù…",
                reset_failed: "Ù„Ù… Ù†ØªÙ…ÙƒÙ† Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¬Ù„Ø³Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",
                start_fresh_q: "Ø§Ù„Ø¨Ø¯Ø¡ Ù…Ù† Ø¬Ø¯ÙŠØ¯ØŸ",
                start_fresh_msg: "Ø³ÙŠØ¤Ø¯ÙŠ Ø°Ù„Ùƒ Ø¥Ù„Ù‰ Ù…Ø³Ø­ Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ ÙˆØ¨Ø¯Ø¡ Ø§Ù„Ø·Ù„Ø¨ Ù…Ù† Ø¬Ø¯ÙŠØ¯.",
                upload_failed: "ØªØ¹Ø°Ø± Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ø³ØªÙ†Ø¯. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",
                upload_error: "Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯.",
                return_dashboard: "Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…",
                verifying: "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øªâ€¦",
                sending: "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„â€¦",
                connection_error_title: "Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„",
                connection_error_msg: "ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",
                logout_q: "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬",
                logout_msg: "Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ",
                exit_session_q: "Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø¬Ù„Ø³Ø©ØŸ",
                exit_session_msg: "Ù‚Ø¯ ÙŠØªÙ… ÙÙ‚Ø¯Ø§Ù† Ø§Ù„ØªÙ‚Ø¯Ù… Ø¥Ø°Ø§ Ù‚Ù…Øª Ø¨Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ø¢Ù†.",
                login_failed_title: "ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",
                req_missing: "Ø¨Ø¹Ø¶ Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ù…ÙÙ‚ÙˆØ¯Ø©",
                enter_otp: "ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ù…Ø±Ø³Ù„ Ø¥Ù„ÙŠÙƒ",
                expired_doc_title: "Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©",
                expired_doc_msg: "Ø§Ù†ØªÙ‡Øª ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø¥Ù…Ø§Ø±Ø§ØªÙŠØ©. Ù„Ø§ ÙŠÙ…ÙƒÙ† Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø¹Ù…Ù„ÙŠØ©.",
                missing_info: "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù†Ø§Ù‚ØµØ©",
                enter_mobile: "ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ù…ØªØ­Ø±Ùƒ ØµØ­ÙŠØ­.",
                review_details_title: "Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",
                eid_no: "Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø¥Ù…Ø§Ø±Ø§ØªÙŠØ©",
                verification_title: "Ø§Ù„ØªØ­Ù‚Ù‚",
                extracted_label: "ØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬Ù‡ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ©",
                verify_notice: "ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ·Ø§Ø¨Ù‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Ø§Ù„Ù‡ÙˆÙŠØ© Ù„ØªØ¬Ù†Ø¨ Ø§Ù„Ø±ÙØ¶.",
                confirm_btn: "ØªØ£ÙƒÙŠØ¯ ÙˆØ§Ù„Ù…ØªØ§Ø¨Ø¹Ø©",
                male: "Ø°ÙƒØ±",
                female: "Ø£Ù†Ø«Ù‰",
                mobile_number_label: "Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ù…ØªØ­Ø±Ùƒ",
                policy_info_label: "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¨ÙˆÙ„ÙŠØµØ©",
                user_details_label: "Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…",
                close_btn: "Ø¥ØºÙ„Ø§Ù‚",
                ai_placeholder: "Ø§Ø³Ø£Ù„Ù†ÙŠ Ø£ÙŠ Ø´ÙŠØ¡ Ø¹Ù† Ø§Ù„ØªØ£Ù…ÙŠÙ†...",
                ai_welcome_msg: "Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ! Ø£Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„ØªØ£Ù…ÙŠÙ† Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ. Ø§Ø³Ø£Ù„Ù†ÙŠ Ø¹Ù† Ø§Ù„ØªØºØ·ÙŠØ©ØŒ Ø£Ùˆ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø´Ø±ÙƒØ©ØŒ Ø£Ùˆ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ.",
                ai_thinking: "Ø¬ÙŠØ§ ØªÙÙƒØ±..."
            },
            hi: {
                welcome: "à¤‡à¤‚à¤¶à¥à¤¯à¥‹à¤°à¥‡à¤‚à¤¸ à¤…à¤¸à¤¿à¤¸à¥à¤Ÿà¥‡à¤‚à¤Ÿ à¤®à¥‡à¤‚ à¤†à¤ªà¤•à¤¾ à¤¸à¥à¤µà¤¾à¤—à¤¤ à¤¹à¥ˆ ğŸ‘‹",
                select_lang: "à¤•à¥ƒà¤ªà¤¯à¤¾ à¤…à¤ªà¤¨à¥€ à¤ªà¤¸à¤‚à¤¦ à¤•à¥€ à¤­à¤¾à¤·à¤¾ à¤šà¥à¤¨à¥‡à¤‚à¥¤",
                looking_for_insurance: "à¤•à¥à¤¯à¤¾ à¤†à¤ª à¤†à¤œ à¤®à¥‡à¤¡à¤¿à¤•à¤² à¤‡à¤‚à¤¶à¥à¤¯à¥‹à¤°à¥‡à¤‚à¤¸ à¤²à¥‡à¤¨à¤¾ à¤šà¤¾à¤¹à¤¤à¥‡ à¤¹à¥ˆà¤‚?",
                yes_start: "à¤¹à¤¾à¤, à¤¶à¥à¤°à¥‚ à¤•à¤°à¥‡à¤‚",
                no_cancel: "à¤¨à¤¹à¥€à¤‚, à¤¬à¤¾à¤¦ à¤®à¥‡à¤‚",
                cancel_msg: "à¤•à¥‹à¤ˆ à¤¬à¤¾à¤¤ à¤¨à¤¹à¥€à¤‚ ğŸ˜Š à¤œà¤¬ à¤œà¤¼à¤°à¥‚à¤°à¤¤ à¤¹à¥‹, à¤¹à¤®à¥‡à¤‚ à¤¬à¤¤à¤¾à¤‡à¤à¥¤",
                employee_or_dependent: "à¤¶à¥à¤°à¥‚ à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤¬à¤¤à¤¾à¤‡à¤ â€” à¤•à¥à¤¯à¤¾ à¤†à¤ª à¤•à¤°à¥à¤®à¤šà¤¾à¤°à¥€ à¤¹à¥ˆà¤‚ à¤¯à¤¾ à¤†à¤¶à¥à¤°à¤¿à¤¤?",
                employee: "à¤•à¤°à¥à¤®à¤šà¤¾à¤°à¥€ (Employee)",
                dependent: "à¤†à¤¶à¥à¤°à¤¿à¤¤ (Dependent)",
                income_self: "à¤†à¤ªà¤•à¥€ à¤®à¤¾à¤¸à¤¿à¤• à¤†à¤¯ à¤•à¤¿à¤¤à¤¨à¥€ à¤¹à¥ˆ?",
                income_sponsor: "à¤†à¤ªà¤•à¥‡ à¤¸à¥à¤ªà¥‰à¤¨à¥à¤¸à¤° à¤•à¥€ à¤®à¤¾à¤¸à¤¿à¤• à¤†à¤¯ à¤•à¤¿à¤¤à¤¨à¥€ à¤¹à¥ˆ?",
                dependent_type_q: "à¤†à¤ª à¤•à¤¿à¤¸ à¤ªà¥à¤°à¤•à¤¾à¤° à¤•à¥‡ à¤†à¤¶à¥à¤°à¤¿à¤¤ à¤¹à¥ˆà¤‚?",
                spouse: "à¤ªà¤¤à¤¿ / à¤ªà¤¤à¥à¤¨à¥€",
                child: "à¤¬à¤šà¥à¤šà¤¾",
                upload_self: "à¤†à¤—à¥‡ à¤¬à¤¢à¤¼à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤…à¤ªà¤¨à¥€ à¤µà¥ˆà¤§ Emirates ID à¤…à¤ªà¤²à¥‹à¤¡ à¤•à¤°à¥‡à¤‚à¥¤",
                upload_sponsor: "à¤†à¤—à¥‡ à¤¬à¤¢à¤¼à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤…à¤ªà¤¨à¥‡ à¤¸à¥à¤ªà¥‰à¤¨à¥à¤¸à¤° à¤•à¥€ Emirates ID à¤…à¤ªà¤²à¥‹à¤¡ à¤•à¤°à¥‡à¤‚à¥¤",
                btn_upload: "à¤¸à¥à¤•à¥ˆà¤¨ à¤•à¤°à¥‡à¤‚ / ID à¤…à¤ªà¤²à¥‹à¤¡ à¤•à¤°à¥‡à¤‚",
                uploading: "ID à¤…à¤ªà¤²à¥‹à¤¡ à¤¹à¥‹ à¤°à¤¹à¥€ à¤¹à¥ˆâ€¦ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤ªà¥à¤°à¤¤à¥€à¤•à¥à¤·à¤¾ à¤•à¤°à¥‡à¤‚à¥¤",
                review_details: "à¤†à¤—à¥‡ à¤¬à¤¢à¤¼à¤¨à¥‡ à¤¸à¥‡ à¤ªà¤¹à¤²à¥‡ à¤…à¤ªà¤¨à¥‡ à¤µà¤¿à¤µà¤°à¤£ à¤•à¥€ à¤œà¤¾à¤à¤š à¤•à¤°à¥‡à¤‚à¥¤",
                verified_details: "à¤¸à¤¤à¥à¤¯à¤¾à¤ªà¤¿à¤¤ à¤µà¤¿à¤µà¤°à¤£",
                name: "à¤ªà¥‚à¤°à¤¾ à¤¨à¤¾à¤®",
                eid: "Emirates ID",
                dob: "à¤œà¤¨à¥à¤® à¤¤à¤¿à¤¥à¤¿",
                nationality: "à¤°à¤¾à¤·à¥à¤Ÿà¥à¤°à¥€à¤¯à¤¤à¤¾",
                gender: "à¤²à¤¿à¤‚à¤—",
                issuing_date: "à¤œà¤¾à¤°à¥€ à¤•à¤°à¤¨à¥‡ à¤•à¥€ à¤¤à¤¿à¤¥à¤¿",
                expiry_date: "à¤¸à¤®à¤¾à¤ªà¥à¤¤à¤¿ à¤¤à¤¿à¤¥à¤¿",
                issuing_place: "à¤œà¤¾à¤°à¥€ à¤•à¤°à¤¨à¥‡ à¤•à¤¾ à¤¸à¥à¤¥à¤¾à¤¨",
                occupation: "à¤ªà¥‡à¤¶à¤¾",
                sponsor: "à¤¸à¥à¤ªà¥‰à¤¨à¥à¤¸à¤°",
                mobile: "à¤®à¥‹à¤¬à¤¾à¤‡à¤² à¤¨à¤‚à¤¬à¤°",
                salary_range_label: "à¤†à¤¯ à¤¸à¥€à¤®à¤¾",
                found_plans: (n) => `à¤…à¤šà¥à¤›à¥€ à¤–à¤¬à¤°! à¤†à¤ªà¤•à¥‡ à¤²à¤¿à¤ ${n} à¤¯à¥‹à¤—à¥à¤¯ à¤ªà¥à¤²à¤¾à¤¨ à¤®à¤¿à¤²à¥‡ à¤¹à¥ˆà¤‚à¥¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤†à¤—à¥‡ à¤¬à¤¢à¤¼à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤à¤• à¤šà¥à¤¨à¥‡à¤‚à¥¤`,
                no_plans: "à¤®à¤¾à¤«à¤¼ à¤•à¥€à¤œà¤¿à¤, à¤†à¤ªà¤•à¥€ à¤†à¤¯ à¤”à¤° à¤œà¤¾à¤°à¥€ à¤¸à¥à¤¥à¤¾à¤¨ à¤•à¥‡ à¤†à¤§à¤¾à¤° à¤ªà¤° à¤…à¤­à¥€ à¤•à¥‹à¤ˆ à¤‘à¤¨à¤²à¤¾à¤‡à¤¨ à¤ªà¥à¤²à¤¾à¤¨ à¤‰à¤ªà¤²à¤¬à¥à¤§ à¤¨à¤¹à¥€à¤‚ à¤¹à¥ˆà¥¤",
                eligible: "à¤¯à¥‹à¤—à¥à¤¯",
                select_plan_msg: (name, type) => `à¤®à¥ˆà¤‚ ${name} (${type}) à¤ªà¥à¤²à¤¾à¤¨ à¤šà¥à¤¨à¤¨à¤¾ à¤šà¤¾à¤¹à¤¤à¤¾/à¤šà¤¾à¤¹à¤¤à¥€ à¤¹à¥‚à¤à¥¤`,
                success_title: "à¤¸à¤«à¤²à¤¤à¤¾ ğŸ‰",
                policy_active: "à¤†à¤ªà¤•à¥€ à¤ªà¥‰à¤²à¤¿à¤¸à¥€ à¤¸à¤•à¥à¤°à¤¿à¤¯ à¤¹à¥‹ à¤—à¤ˆ à¤¹à¥ˆ",
                policy_no: "à¤ªà¥‰à¤²à¤¿à¤¸à¥€ à¤¨à¤‚à¤¬à¤°",
                premium: "à¤ªà¥à¤°à¥€à¤®à¤¿à¤¯à¤® à¤°à¤¾à¤¶à¤¿",
                continue_btn: "à¤œà¤¾à¤°à¥€ à¤°à¤–à¥‡à¤‚",
                welcome_back: "à¤µà¤¾à¤ªà¤¸à¥€ à¤ªà¤° à¤¸à¥à¤µà¤¾à¤—à¤¤ à¤¹à¥ˆ! à¤†à¤ªà¤•à¤¾ à¤ªà¤¿à¤›à¤²à¤¾ à¤¸à¤¤à¥à¤° à¤¬à¤¹à¤¾à¤² à¤•à¤° à¤¦à¤¿à¤¯à¤¾ à¤—à¤¯à¤¾ à¤¹à¥ˆà¥¤",
                continue_income: "à¤œà¤¹à¤¾à¤ à¤¸à¥‡ à¤°à¥à¤•à¥‡ à¤¥à¥‡, à¤µà¤¹à¥€à¤‚ à¤¸à¥‡ à¤†à¤—à¥‡ à¤¬à¤¢à¤¼à¤¤à¥‡ à¤¹à¥ˆà¤‚à¥¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤†à¤¯ à¤¸à¥€à¤®à¤¾ à¤šà¥à¤¨à¥‡à¤‚à¥¤",
                restart_prompt: "à¤†à¤µà¥‡à¤¦à¤¨ à¤œà¤¾à¤°à¥€ à¤°à¤–à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤Šà¤ªà¤° à¤¦à¤¿à¤ à¤—à¤ à¤µà¤¿à¤•à¤²à¥à¤ªà¥‹à¤‚ à¤•à¤¾ à¤‰à¤ªà¤¯à¥‹à¤— à¤•à¤°à¥‡à¤‚à¥¤",
                below_4000: "4000 AED à¤¸à¥‡ à¤•à¤®",
                between_4000_5000: "4000 â€“ 5000 AED",
                above_5000: "5000 AED à¤¸à¥‡ à¤…à¤§à¤¿à¤•",
                reset_failed: "à¤¸à¤¤à¥à¤° à¤°à¥€à¤¸à¥‡à¤Ÿ à¤¨à¤¹à¥€à¤‚ à¤¹à¥‹ à¤¸à¤•à¤¾à¥¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤¦à¥‹à¤¬à¤¾à¤°à¤¾ à¤ªà¥à¤°à¤¯à¤¾à¤¸ à¤•à¤°à¥‡à¤‚à¥¤",
                start_fresh_q: "à¤«à¤¿à¤° à¤¸à¥‡ à¤¶à¥à¤°à¥‚ à¤•à¤°à¥‡à¤‚?",
                start_fresh_msg: "à¤‡à¤¸à¤¸à¥‡ à¤†à¤ªà¤•à¥€ à¤®à¥Œà¤œà¥‚à¤¦à¤¾ à¤ªà¥à¤°à¤—à¤¤à¤¿ à¤®à¤¿à¤Ÿ à¤œà¤¾à¤à¤—à¥€ à¤”à¤° à¤ªà¥à¤°à¤•à¥à¤°à¤¿à¤¯à¤¾ à¤¦à¥‹à¤¬à¤¾à¤°à¤¾ à¤¶à¥à¤°à¥‚ à¤¹à¥‹à¤—à¥€à¥¤",
                upload_failed: "à¤¦à¤¸à¥à¤¤à¤¾à¤µà¥‡à¤œà¤¼ à¤ªà¥à¤°à¥‹à¤¸à¥‡à¤¸ à¤¨à¤¹à¥€à¤‚ à¤¹à¥‹ à¤¸à¤•à¤¾à¥¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤«à¤¿à¤° à¤¸à¥‡ à¤ªà¥à¤°à¤¯à¤¾à¤¸ à¤•à¤°à¥‡à¤‚à¥¤",
                upload_error: "à¤¦à¤¸à¥à¤¤à¤¾à¤µà¥‡à¤œà¤¼ à¤…à¤ªà¤²à¥‹à¤¡ à¤•à¤°à¤¤à¥‡ à¤¸à¤®à¤¯ à¤¤à¥à¤°à¥à¤Ÿà¤¿ à¤¹à¥à¤ˆà¥¤",
                return_dashboard: "à¤¡à¥ˆà¤¶à¤¬à¥‹à¤°à¥à¤¡ à¤ªà¤° à¤µà¤¾à¤ªà¤¸ à¤œà¤¾à¤à¤",
                verifying: "à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€ à¤¸à¤¤à¥à¤¯à¤¾à¤ªà¤¿à¤¤ à¤•à¥€ à¤œà¤¾ à¤°à¤¹à¥€ à¤¹à¥ˆâ€¦",
                sending: "à¤­à¥‡à¤œà¤¾ à¤œà¤¾ à¤°à¤¹à¤¾ à¤¹à¥ˆâ€¦",
                connection_error_title: "à¤•à¤¨à¥‡à¤•à¥à¤¶à¤¨ à¤¸à¤®à¤¸à¥à¤¯à¤¾",
                connection_error_msg: "à¤•à¥ƒà¤ªà¤¯à¤¾ à¤…à¤ªà¤¨à¤¾ à¤‡à¤‚à¤Ÿà¤°à¤¨à¥‡à¤Ÿ à¤•à¤¨à¥‡à¤•à¥à¤¶à¤¨ à¤œà¤¾à¤à¤šà¥‡à¤‚ à¤”à¤° à¤«à¤¿à¤° à¤•à¥‹à¤¶à¤¿à¤¶ à¤•à¤°à¥‡à¤‚à¥¤",
                logout_q: "à¤²à¥‰à¤— à¤†à¤‰à¤Ÿ à¤•à¤°à¥‡à¤‚?",
                logout_msg: "à¤•à¥à¤¯à¤¾ à¤†à¤ª à¤µà¤¾à¤•à¤ˆ à¤²à¥‰à¤— à¤†à¤‰à¤Ÿ à¤•à¤°à¤¨à¤¾ à¤šà¤¾à¤¹à¤¤à¥‡ à¤¹à¥ˆà¤‚?",
                exit_session_q: "à¤¸à¤¤à¥à¤° à¤¸à¤®à¤¾à¤ªà¥à¤¤ à¤•à¤°à¥‡à¤‚?",
                exit_session_msg: "à¤…à¤­à¥€ à¤¬à¤¾à¤¹à¤° à¤¨à¤¿à¤•à¤²à¤¨à¥‡ à¤ªà¤° à¤†à¤ªà¤•à¥€ à¤ªà¥à¤°à¤—à¤¤à¤¿ à¤–à¥‹ à¤¸à¤•à¤¤à¥€ à¤¹à¥ˆà¥¤",
                login_failed_title: "à¤²à¥‰à¤—à¤¿à¤¨ à¤…à¤¸à¤«à¤²",
                req_missing: "à¤•à¥à¤› à¤†à¤µà¤¶à¥à¤¯à¤• à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€ à¤…à¤§à¥‚à¤°à¥€ à¤¹à¥ˆ",
                enter_otp: "à¤•à¥ƒà¤ªà¤¯à¤¾ à¤†à¤ªà¤•à¥‹ à¤­à¥‡à¤œà¤¾ à¤—à¤¯à¤¾ à¤¸à¤¤à¥à¤¯à¤¾à¤ªà¤¨ à¤•à¥‹à¤¡ à¤¦à¤°à¥à¤œ à¤•à¤°à¥‡à¤‚",
                expired_doc_title: "à¤¦à¤¸à¥à¤¤à¤¾à¤µà¥‡à¤œà¤¼ à¤•à¥€ à¤…à¤µà¤§à¤¿ à¤¸à¤®à¤¾à¤ªà¥à¤¤",
                expired_doc_msg: "Emirates ID à¤•à¥€ à¤…à¤µà¤§à¤¿ à¤¸à¤®à¤¾à¤ªà¥à¤¤ à¤¹à¥‹ à¤šà¥à¤•à¥€ à¤¹à¥ˆà¥¤ à¤ªà¥à¤°à¤•à¥à¤°à¤¿à¤¯à¤¾ à¤†à¤—à¥‡ à¤¨à¤¹à¥€à¤‚ à¤¬à¤¢à¤¼ à¤¸à¤•à¤¤à¥€à¥¤",
                missing_info: "à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€ à¤…à¤§à¥‚à¤°à¥€ à¤¹à¥ˆ",
                enter_mobile: "à¤•à¥ƒà¤ªà¤¯à¤¾ à¤à¤• à¤µà¥ˆà¤§ à¤®à¥‹à¤¬à¤¾à¤‡à¤² à¤¨à¤‚à¤¬à¤° à¤¦à¤°à¥à¤œ à¤•à¤°à¥‡à¤‚à¥¤",
                review_details_title: "à¤µà¤¿à¤µà¤°à¤£ à¤•à¥€ à¤¸à¤®à¥€à¤•à¥à¤·à¤¾ à¤•à¤°à¥‡à¤‚",
                eid_no: "Emirates ID à¤¨à¤‚à¤¬à¤°",
                verification_title: "à¤¸à¤¤à¥à¤¯à¤¾à¤ªà¤¨",
                extracted_label: "ID à¤¸à¥‡ à¤ªà¥à¤°à¤¾à¤ªà¥à¤¤ à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€",
                verify_notice: "à¤…à¤¸à¥à¤µà¥€à¤•à¥ƒà¤¤à¤¿ à¤¸à¥‡ à¤¬à¤šà¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤µà¤¿à¤µà¤°à¤£ Emirates ID à¤¸à¥‡ à¤®à¤¿à¤²à¤¾à¤¨ à¤•à¤°à¥‡à¤‚à¥¤",
                confirm_btn: "à¤ªà¥à¤·à¥à¤Ÿà¤¿ à¤•à¤°à¥‡à¤‚ à¤”à¤° à¤†à¤—à¥‡ à¤¬à¤¢à¤¼à¥‡à¤‚",
                male: "à¤ªà¥à¤°à¥à¤·",
                female: "à¤®à¤¹à¤¿à¤²à¤¾",
                mobile_number_label: "à¤®à¥‹à¤¬à¤¾à¤‡à¤² à¤¨à¤‚à¤¬à¤°",
                policy_info_label: "à¤ªà¥‰à¤²à¤¿à¤¸à¥€ à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€",
                user_details_label: "à¤‰à¤ªà¤¯à¥‹à¤—à¤•à¤°à¥à¤¤à¤¾ à¤µà¤¿à¤µà¤°à¤£",
                close_btn: "à¤¬à¤‚à¤¦ à¤•à¤°à¥‡à¤‚",
                ai_placeholder: "à¤¬à¥€à¤®à¤¾ à¤•à¥‡ à¤¬à¤¾à¤°à¥‡ à¤®à¥‡à¤‚ à¤•à¥à¤› à¤­à¥€ à¤ªà¥‚à¤›à¥‡à¤‚...",
                ai_welcome_msg: "à¤¨à¤®à¤¸à¥à¤¤à¥‡! à¤®à¥ˆà¤‚ à¤†à¤ªà¤•à¤¾ à¤‡à¤‚à¤¶à¥à¤¯à¥‹à¤°à¥‡à¤‚à¤¸ à¤…à¤¸à¤¿à¤¸à¥à¤Ÿà¥‡à¤‚à¤Ÿ à¤¹à¥‚à¤à¥¤ à¤®à¥à¤à¤¸à¥‡ à¤•à¤µà¤°à¥‡à¤œ, à¤•à¤‚à¤ªà¤¨à¥€ à¤µà¤¿à¤µà¤°à¤£ à¤¯à¤¾ à¤¸à¤¹à¤¾à¤¯à¤¤à¤¾ à¤•à¥‡ à¤¬à¤¾à¤°à¥‡ à¤®à¥‡à¤‚ à¤ªà¥‚à¤›à¥‡à¤‚à¥¤",
                ai_thinking: "à¤œà¤¿à¤¯à¤¾ à¤¸à¥‹à¤š à¤°à¤¹à¥€ à¤¹à¥ˆ..."
            },
            ur: {
                welcome: "Ø§Ù†Ø´ÙˆØ±Ù†Ø³ Ø§Ø³Ø³Ù¹Ù†Ù¹ Ù…ÛŒÚº Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯ ğŸ‘‹",
                select_lang: "Ø¨Ø±Ø§ÛÙ Ú©Ø±Ù… Ø§Ù¾Ù†ÛŒ Ù¾Ø³Ù†Ø¯ Ú©ÛŒ Ø²Ø¨Ø§Ù† Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚºÛ”",
                looking_for_insurance: "Ú©ÛŒØ§ Ø¢Ù¾ Ø¢Ø¬ Ù…ÛŒÚˆÛŒÚ©Ù„ Ø§Ù†Ø´ÙˆØ±Ù†Ø³ Ù„ÛŒÙ†Ø§ Ú†Ø§ÛØªÛ’ ÛÛŒÚºØŸ",
                yes_start: "Ø¬ÛŒ ÛØ§ÚºØŒ Ø´Ø±ÙˆØ¹ Ú©Ø±ÛŒÚº",
                no_cancel: "Ù†ÛÛŒÚºØŒ Ø¨Ø¹Ø¯ Ù…ÛŒÚº",
                cancel_msg: "Ú©ÙˆØ¦ÛŒ Ù…Ø³Ø¦Ù„Û Ù†ÛÛŒÚº ğŸ˜Š Ø¬Ø¨ Ø¶Ø±ÙˆØ±Øª ÛÙˆ ÛÙ…ÛŒÚº Ø¨ØªØ§Ø¦ÛŒÚºÛ”",
                employee_or_dependent: "Ø´Ø±ÙˆØ¹ Ú©Ø±Ù†Û’ Ú©Û’ Ù„ÛŒÛ’ Ø¨ØªØ§Ø¦ÛŒÚº â€” Ú©ÛŒØ§ Ø¢Ù¾ Ù…Ù„Ø§Ø²Ù… ÛÛŒÚº ÛŒØ§ Ø²ÛŒØ±Ù Ú©ÙØ§Ù„ØªØŸ",
                employee: "Ù…Ù„Ø§Ø²Ù… (Employee)",
                dependent: "Ø²ÛŒØ±Ù Ú©ÙØ§Ù„Øª (Dependent)",
                income_self: "Ø¢Ù¾ Ú©ÛŒ Ù…Ø§ÛØ§Ù†Û Ø¢Ù…Ø¯Ù†ÛŒ Ú©ØªÙ†ÛŒ ÛÛ’ØŸ",
                income_sponsor: "Ø¢Ù¾ Ú©Û’ Ø§Ø³Ù¾Ø§Ù†Ø³Ø± Ú©ÛŒ Ù…Ø§ÛØ§Ù†Û Ø¢Ù…Ø¯Ù†ÛŒ Ú©ØªÙ†ÛŒ ÛÛ’ØŸ",
                dependent_type_q: "Ø¢Ù¾ Ú©Ø³ Ù‚Ø³Ù… Ú©Û’ Ø²ÛŒØ±Ù Ú©ÙØ§Ù„Øª ÛÛŒÚºØŸ",
                spouse: "Ø´ÙˆÛØ± / Ø¨ÛŒÙˆÛŒ",
                child: "Ø¨Ú†Û",
                upload_self: "Ø¢Ú¯Û’ Ø¨Ú‘Ú¾Ù†Û’ Ú©Û’ Ù„ÛŒÛ’ Ø¨Ø±Ø§ÛÙ Ú©Ø±Ù… Ø§Ù¾Ù†ÛŒ Ø¯Ø±Ø³Øª Emirates ID Ø§Ù¾ Ù„ÙˆÚˆ Ú©Ø±ÛŒÚºÛ”",
                upload_sponsor: "Ø¢Ú¯Û’ Ø¨Ú‘Ú¾Ù†Û’ Ú©Û’ Ù„ÛŒÛ’ Ø¨Ø±Ø§ÛÙ Ú©Ø±Ù… Ø§Ù¾Ù†Û’ Ø§Ø³Ù¾Ø§Ù†Ø³Ø± Ú©ÛŒ Emirates ID Ø§Ù¾ Ù„ÙˆÚˆ Ú©Ø±ÛŒÚºÛ”",
                btn_upload: "Ø§Ø³Ú©ÛŒÙ† Ú©Ø±ÛŒÚº / ID Ø§Ù¾ Ù„ÙˆÚˆ Ú©Ø±ÛŒÚº",
                uploading: "ID Ø§Ù¾ Ù„ÙˆÚˆ ÛÙˆ Ø±ÛÛŒ ÛÛ’â€¦ Ø¨Ø±Ø§ÛÙ Ú©Ø±Ù… Ø§Ù†ØªØ¸Ø§Ø± Ú©Ø±ÛŒÚºÛ”",
                review_details: "Ø¢Ú¯Û’ Ø¨Ú‘Ú¾Ù†Û’ Ø³Û’ Ù¾ÛÙ„Û’ Ø§Ù¾Ù†ÛŒ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØºÙˆØ± Ø³Û’ Ú†ÛŒÚ© Ú©Ø±ÛŒÚºÛ”",
                verified_details: "ØªØµØ¯ÛŒÙ‚ Ø´Ø¯Û Ù…Ø¹Ù„ÙˆÙ…Ø§Øª",
                name: "Ù¾ÙˆØ±Ø§ Ù†Ø§Ù…",
                eid: "Emirates ID",
                dob: "ØªØ§Ø±ÛŒØ®Ù Ù¾ÛŒØ¯Ø§Ø¦Ø´",
                nationality: "Ù‚ÙˆÙ…ÛŒØª",
                gender: "Ø¬Ù†Ø³",
                issuing_date: "Ø§Ø¬Ø±Ø§Ø¡ Ú©ÛŒ ØªØ§Ø±ÛŒØ®",
                expiry_date: "Ù…ÛŒØ¹Ø§Ø¯ Ø®ØªÙ… ÛÙˆÙ†Û’ Ú©ÛŒ ØªØ§Ø±ÛŒØ®",
                issuing_place: "Ø§Ø¬Ø±Ø§Ø¡ Ú©ÛŒ Ø¬Ú¯Û",
                occupation: "Ù¾ÛŒØ´Û",
                sponsor: "Ø§Ø³Ù¾Ø§Ù†Ø³Ø±",
                mobile: "Ù…ÙˆØ¨Ø§Ø¦Ù„ Ù†Ù…Ø¨Ø±",
                salary_range_label: "Ø¢Ù…Ø¯Ù†ÛŒ Ú©ÛŒ Ø­Ø¯",
                found_plans: (n) => `Ø®ÙˆØ´Ø®Ø¨Ø±ÛŒ! Ø¢Ù¾ Ú©Û’ Ù„ÛŒÛ’ ${n} Ø§ÛÙ„ Ù¾Ù„Ø§Ù† Ø¯Ø³ØªÛŒØ§Ø¨ ÛÛŒÚºÛ” Ø¨Ø±Ø§ÛÙ Ú©Ø±Ù… Ø§ÛŒÚ© Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚºÛ”`,
                no_plans: "Ù…Ø¹Ø°Ø±ØªØŒ Ø¢Ù¾ Ú©ÛŒ Ø¢Ù…Ø¯Ù†ÛŒ Ø§ÙˆØ± Ø§Ø¬Ø±Ø§Ø¡ Ú©ÛŒ Ø¬Ú¯Û Ú©Û’ Ù…Ø·Ø§Ø¨Ù‚ Ø§Ø³ ÙˆÙ‚Øª Ú©ÙˆØ¦ÛŒ Ø¢Ù† Ù„Ø§Ø¦Ù† Ù¾Ù„Ø§Ù† Ø¯Ø³ØªÛŒØ§Ø¨ Ù†ÛÛŒÚº ÛÛ’Û”",
                eligible: "Ø§ÛÙ„",
                select_plan_msg: (name, type) => `Ù…ÛŒÚº ${name} (${type}) Ù¾Ù„Ø§Ù† Ù…Ù†ØªØ®Ø¨ Ú©Ø±Ù†Ø§ Ú†Ø§ÛØªØ§/Ú†Ø§ÛØªÛŒ ÛÙˆÚºÛ”`,
                success_title: "Ú©Ø§Ù…ÛŒØ§Ø¨ÛŒ ğŸ‰",
                policy_active: "Ø¢Ù¾ Ú©ÛŒ Ù¾Ø§Ù„ÛŒØ³ÛŒ ÙØ¹Ø§Ù„ ÛÙˆ Ú¯Ø¦ÛŒ ÛÛ’",
                policy_no: "Ù¾Ø§Ù„ÛŒØ³ÛŒ Ù†Ù…Ø¨Ø±",
                premium: "Ù¾Ø±ÛŒÙ…ÛŒÙ… Ø±Ù‚Ù…",
                continue_btn: "Ø¬Ø§Ø±ÛŒ Ø±Ú©Ú¾ÛŒÚº",
                welcome_back: "Ø¯ÙˆØ¨Ø§Ø±Û Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯! Ø¢Ù¾ Ú©Ø§ Ù¾Ú†Ú¾Ù„Ø§ Ø³ÛŒØ´Ù† Ø¨Ø­Ø§Ù„ Ú©Ø± Ø¯ÛŒØ§ Ú¯ÛŒØ§ ÛÛ’Û”",
                continue_income: "Ø¬ÛØ§Úº Ø³Û’ Ø¢Ù¾ Ø±Ú©Û’ ØªÚ¾Û’ ÙˆÛÛŒÚº Ø³Û’ Ø¢Ú¯Û’ Ø¨Ú‘Ú¾ØªÛ’ ÛÛŒÚºÛ” Ø¨Ø±Ø§ÛÙ Ú©Ø±Ù… Ø¢Ù…Ø¯Ù†ÛŒ Ú©ÛŒ Ø­Ø¯ Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚºÛ”",
                restart_prompt: "Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¬Ø§Ø±ÛŒ Ø±Ú©Ú¾Ù†Û’ Ú©Û’ Ù„ÛŒÛ’ Ø§ÙˆÙ¾Ø± Ø¯ÛŒÛ’ Ú¯Ø¦Û’ Ø§Ø®ØªÛŒØ§Ø±Ø§Øª Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ú©Ø±ÛŒÚºÛ”",
                below_4000: "4000 AED Ø³Û’ Ú©Ù…",
                between_4000_5000: "4000 â€“ 5000 AED",
                above_5000: "5000 AED Ø³Û’ Ø²ÛŒØ§Ø¯Û",
                reset_failed: "Ø³ÛŒØ´Ù† Ø±ÛŒ Ø³ÛŒÙ¹ Ù†ÛÛŒÚº ÛÙˆ Ø³Ú©Ø§Û” Ø¨Ø±Ø§ÛÙ Ú©Ø±Ù… Ø¯ÙˆØ¨Ø§Ø±Û Ú©ÙˆØ´Ø´ Ú©Ø±ÛŒÚºÛ”",
                start_fresh_q: "Ø¯ÙˆØ¨Ø§Ø±Û Ø´Ø±ÙˆØ¹ Ú©Ø±ÛŒÚºØŸ",
                start_fresh_msg: "Ø§Ø³ Ø³Û’ Ù…ÙˆØ¬ÙˆØ¯Û Ù¾ÛŒØ´ Ø±ÙØª Ø®ØªÙ… ÛÙˆ Ø¬Ø§Ø¦Û’ Ú¯ÛŒ Ø§ÙˆØ± Ø¹Ù…Ù„ Ø¯ÙˆØ¨Ø§Ø±Û Ø´Ø±ÙˆØ¹ ÛÙˆÚ¯Ø§Û”",
                upload_failed: "Ø¯Ø³ØªØ§ÙˆÛŒØ² Ù¾Ø± Ú©Ø§Ø±Ø±ÙˆØ§Ø¦ÛŒ Ù†ÛÛŒÚº ÛÙˆ Ø³Ú©ÛŒÛ” Ø¨Ø±Ø§ÛÙ Ú©Ø±Ù… Ø¯ÙˆØ¨Ø§Ø±Û Ú©ÙˆØ´Ø´ Ú©Ø±ÛŒÚºÛ”",
                upload_error: "Ø¯Ø³ØªØ§ÙˆÛŒØ² Ø§Ù¾ Ù„ÙˆÚˆ Ú©Ø±ØªÛ’ ÙˆÙ‚Øª Ù…Ø³Ø¦Ù„Û Ù¾ÛŒØ´ Ø¢ÛŒØ§Û”",
                return_dashboard: "ÚˆÛŒØ´ Ø¨ÙˆØ±Úˆ Ù¾Ø± ÙˆØ§Ù¾Ø³ Ø¬Ø§Ø¦ÛŒÚº",
                verifying: "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ú©ÛŒ ØªØµØ¯ÛŒÙ‚ Ú©ÛŒ Ø¬Ø§ Ø±ÛÛŒ ÛÛ’â€¦",
                sending: "Ø¨Ú¾ÛŒØ¬Ø§ Ø¬Ø§ Ø±ÛØ§ ÛÛ’â€¦",
                connection_error_title: "Ú©Ù†Ú©Ø´Ù† Ú©Ø§ Ù…Ø³Ø¦Ù„Û",
                connection_error_msg: "Ø¨Ø±Ø§ÛÙ Ú©Ø±Ù… Ø§Ù†Ù¹Ø±Ù†ÛŒÙ¹ Ú©Ù†Ú©Ø´Ù† Ú†ÛŒÚ© Ú©Ø±ÛŒÚº Ø§ÙˆØ± Ø¯ÙˆØ¨Ø§Ø±Û Ú©ÙˆØ´Ø´ Ú©Ø±ÛŒÚºÛ”",
                logout_q: "Ù„Ø§Ú¯ Ø¢Ø¤Ù¹ Ú©Ø±ÛŒÚºØŸ",
                logout_msg: "Ú©ÛŒØ§ Ø¢Ù¾ ÙˆØ§Ù‚Ø¹ÛŒ Ù„Ø§Ú¯ Ø¢Ø¤Ù¹ Ú©Ø±Ù†Ø§ Ú†Ø§ÛØªÛ’ ÛÛŒÚºØŸ",
                exit_session_q: "Ø³ÛŒØ´Ù† Ø®ØªÙ… Ú©Ø±ÛŒÚºØŸ",
                exit_session_msg: "Ø§Ø¨Ú¾ÛŒ Ø¨Ø§ÛØ± Ù†Ú©Ù„Ù†Û’ Ø³Û’ Ø¢Ù¾ Ú©ÛŒ Ù¾ÛŒØ´ Ø±ÙØª Ø¶Ø§Ø¦Ø¹ ÛÙˆ Ø³Ú©ØªÛŒ ÛÛ’Û”",
                login_failed_title: "Ù„Ø§Ú¯ Ø§ÙÙ† Ù†Ø§Ú©Ø§Ù…",
                req_missing: "Ú©Ú†Ú¾ Ø¶Ø±ÙˆØ±ÛŒ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛÛŒÚº ÛÛŒÚº",
                enter_otp: "Ø¨Ø±Ø§ÛÙ Ú©Ø±Ù… Ø¢Ù¾ Ú©Ùˆ Ø¨Ú¾ÛŒØ¬Ø§ Ú¯ÛŒØ§ ØªØµØ¯ÛŒÙ‚ÛŒ Ú©ÙˆÚˆ Ø¯Ø±Ø¬ Ú©Ø±ÛŒÚº",
                expired_doc_title: "Ø¯Ø³ØªØ§ÙˆÛŒØ² Ú©ÛŒ Ù…ÛŒØ¹Ø§Ø¯ Ø®ØªÙ…",
                expired_doc_msg: "Emirates ID Ú©ÛŒ Ù…ÛŒØ¹Ø§Ø¯ Ø®ØªÙ… ÛÙˆ Ú†Ú©ÛŒ ÛÛ’Û” Ø¹Ù…Ù„ Ø¬Ø§Ø±ÛŒ Ù†ÛÛŒÚº Ø±Ú©Ú¾Ø§ Ø¬Ø§ Ø³Ú©ØªØ§Û”",
                missing_info: "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù†Ø§Ù…Ú©Ù…Ù„ ÛÛŒÚº",
                enter_mobile: "Ø¨Ø±Ø§ÛÙ Ú©Ø±Ù… Ø¯Ø±Ø³Øª Ù…ÙˆØ¨Ø§Ø¦Ù„ Ù†Ù…Ø¨Ø± Ø¯Ø±Ø¬ Ú©Ø±ÛŒÚºÛ”",
                review_details_title: "ØªÙØµÛŒÙ„Ø§Øª Ú©Ø§ Ø¬Ø§Ø¦Ø²Û Ù„ÛŒÚº",
                eid_no: "Emirates ID Ù†Ù…Ø¨Ø±",
                verification_title: "ØªØµØ¯ÛŒÙ‚",
                extracted_label: "ID Ø³Û’ Ø­Ø§ØµÙ„ Ú©Ø±Ø¯Û Ù…Ø¹Ù„ÙˆÙ…Ø§Øª",
                verify_notice: "Ø±Ø¯ ÛÙˆÙ†Û’ Ø³Û’ Ø¨Ú†Ù†Û’ Ú©Û’ Ù„ÛŒÛ’ ØªØµØ¯ÛŒÙ‚ Ú©Ø±ÛŒÚº Ú©Û Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ID Ø³Û’ Ù…Ø·Ø§Ø¨Ù‚Øª Ø±Ú©Ú¾ØªÛŒ ÛÛŒÚºÛ”",
                confirm_btn: "ØªØµØ¯ÛŒÙ‚ Ú©Ø±ÛŒÚº Ø§ÙˆØ± Ø¢Ú¯Û’ Ø¨Ú‘Ú¾ÛŒÚº",
                male: "Ù…Ø±Ø¯",
                female: "Ø¹ÙˆØ±Øª",
                mobile_number_label: "Ù…ÙˆØ¨Ø§Ø¦Ù„ Ù†Ù…Ø¨Ø±",
                policy_info_label: "Ù¾Ø§Ù„ÛŒØ³ÛŒ Ú©ÛŒ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª",
                user_details_label: "ØµØ§Ø±Ù Ú©ÛŒ ØªÙØµÛŒÙ„Ø§Øª",
                close_btn: "Ø¨Ù†Ø¯ Ú©Ø±ÛŒÚº",
                ai_placeholder: "Ø§Ù†Ø´ÙˆØ±Ù†Ø³ Ú©Û’ Ø¨Ø§Ø±Û’ Ù…ÛŒÚº Ú©Ú†Ú¾ Ø¨Ú¾ÛŒ Ù¾ÙˆÚ†Ú¾ÛŒÚº...",
                ai_welcome_msg: "ÛÛŒÙ„Ùˆ! Ù…ÛŒÚº Ø¢Ù¾ Ú©Ø§ Ø§Ù†Ø´ÙˆØ±Ù†Ø³ Ø§Ø³Ø³Ù¹Ù†Ù¹ ÛÙˆÚºÛ” Ù…Ø¬Ú¾ Ø³Û’ Ú©ÙˆØ±ÛŒØ¬ØŒ Ú©Ù…Ù¾Ù†ÛŒ Ú©ÛŒ ØªÙØµÛŒÙ„Ø§ØªØŒ ÛŒØ§ Ø³Ù¾ÙˆØ±Ù¹ Ú©Û’ Ø¨Ø§Ø±Û’ Ù…ÛŒÚº Ù¾ÙˆÚ†Ú¾ÛŒÚºÛ”",
                ai_thinking: "Ø§ÙˆØ±Ø§ Ø³ÙˆÚ† Ø±ÛÛŒ ÛÛ’..."
            }
        };

        function t(key, ...args) {
            const lang = state.insuranceData.lang || 'en';
            const dict = translations[lang] || translations.en;
            const val = dict[key] || translations.en[key] || key;
            if (typeof val === 'function') return val(...args);
            return val;
        }

        function isRTL() {
            const lang = state.insuranceData.lang || 'en';
            return ['ar', 'ur'].includes(lang);
        }

        // --- STATE ---
        const state = {
            user: null,
            mode: 'none', // 'insurance' or 'ai'
            insuranceData: {},
            chatHistory: [],
            aiChatHistory: [],
            policies: []
        };

        function authHeaders(extra = {}) {
            const token = localStorage.getItem('access_token');
            const headers = { ...extra };
            if (token && token !== 'undefined' && token !== 'null') {
                headers['Authorization'] = `Bearer ${token}`;
            }
            return headers;
        }


        function getCurrentStream() {
            return state.mode === 'ai'
                ? document.getElementById('ai-chat-stream')
                : document.getElementById('chat-stream');
        }

        // --- COOKIE HELPER ---
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        // --- API HELPER ---
        // async function apiCall(endpoint, method = 'GET', data = null, isFileUpload = false) {
        //     const options = {
        //         method: method,
        //         credentials: 'include', // Important for cookies/session
        //         headers: {
        //             'X-CSRFToken': getCookie('csrftoken') // Add CSRF Token
        //         }
        //     };

        //     if (data) {
        //         if (isFileUpload) {
        //             options.body = data; // FormData content-type is auto-set
        //         } else {
        //             options.headers['Content-Type'] = 'application/json';
        //             options.body = JSON.stringify(data);
        //         }
        //     }

        //     try {
        //         const response = await fetch(`${API_BASE}${endpoint}`, options);
        //         const result = await response.json();
        //         return result;
        //     } catch (error) {
        //         console.error('API Error:', error);
        //         showAlert('error', t('connection_error_title'), t('connection_error_msg'));
        //         return { success: false, message: 'Network or Server Error' };
        //     }
        // }

        async function apiCall(endpoint, method = 'GET', data = null, isFileUpload = false) {
            const headers = authHeaders();

            if (!isFileUpload) {
                headers['Content-Type'] = 'application/json';
            }

            const options = {
                method,
                headers
            };

            if (data) {
                options.body = isFileUpload ? data : JSON.stringify(data);
            }

            try {
                const response = await fetch(`${API_BASE}${endpoint}`, options);
                const result = await response.json();
                return result;
            } catch (error) {
                console.error('API Error:', error);
                showAlert('error', t('connection_error_title'), t('connection_error_msg'));
                return { success: false };
            }
        }


        // --- CUSTOM UI ALERTS ---
        let alertPromiseResolve = null;

        /**
         * Custom Alert System
         * @param {string} type - 'success', 'error', 'warning', 'info', 'confirm'
         */
        function showAlert(type, title, message, callback = null) {
            const modal = document.getElementById('modal-alert');
            const iconContainer = document.getElementById('alert-icon-container');
            const icon = document.getElementById('alert-icon');
            const titleEl = document.getElementById('alert-title');
            const msgEl = document.getElementById('alert-message');
            const accent = document.getElementById('alert-accent');
            const confirmBtn = document.getElementById('alert-btn-confirm');
            const cancelBtn = document.getElementById('alert-btn-cancel');

            // Reset
            cancelBtn.classList.add('hidden');
            confirmBtn.innerText = 'Okay';

            // Map types to styles
            const configs = {
                success: { icon: 'check', color: 'bg-emerald-500', iconColor: 'text-emerald-500', bg: 'bg-emerald-50', accent: 'bg-emerald-500' },
                error: { icon: 'x-circle', color: 'bg-red-500', iconColor: 'text-red-500', bg: 'bg-red-50', accent: 'bg-red-500' },
                warning: { icon: 'alert-triangle', color: 'bg-amber-500', iconColor: 'text-amber-500', bg: 'bg-amber-50', accent: 'bg-amber-500' },
                info: { icon: 'info', color: 'bg-brand-500', iconColor: 'text-brand-500', bg: 'bg-brand-50', accent: 'bg-brand-500' },
                confirm: { icon: 'help-circle', color: 'bg-brand-500', iconColor: 'text-brand-500', bg: 'bg-brand-50', accent: 'bg-brand-500' }
            };

            const config = configs[type] || configs.info;

            icon.setAttribute('data-lucide', config.icon);
            iconContainer.className = `w-16 h-16 rounded-2xl flex items-center justify-center mb-6 shadow-soft ${config.bg} ${config.iconColor}`;
            accent.className = `absolute top-0 left-0 w-full h-2 ${config.accent}`;
            titleEl.innerText = title;
            msgEl.innerText = message;

            if (type === 'confirm') {
                cancelBtn.classList.remove('hidden');
                confirmBtn.innerText = 'Confirm';
            }

            modal.classList.remove('hidden');
            document.body.classList.add('modal-open');
            lucide.createIcons();

            return new Promise((resolve) => {
                confirmBtn.onclick = () => {
                    modal.classList.add('hidden');
                    document.body.classList.remove('modal-open');
                    if (callback) callback(true);
                    resolve(true);
                };
                cancelBtn.onclick = () => {
                    modal.classList.add('hidden');
                    document.body.classList.remove('modal-open');
                    if (callback) callback(false);
                    resolve(false);
                };
            });
        }

        // --- AUTH CHECK ---
        async function checkAuth() {
            const token = localStorage.getItem('access_token');

            if (token) {
                // Fetch User Details
                try {
                    const res = await apiCall('/auth/me/');
                    if (res.success) {
                        state.user = res.user;
                        updateUserHeader();
                    }
                } catch (e) {
                    console.error("Auth check failed", e);
                }

                showView('view-landing');
                fetchPolicies();
            } else {
                showView('view-login');
            }
        }


        // --- NAVIGATION ---
        function showView(viewId) {
            // Hide all sections inside main
            document.querySelectorAll('main > section').forEach(el => el.classList.add('hidden'));

            // Show requested view
            const view = document.getElementById(viewId);
            view.classList.remove('hidden');

            const header = document.getElementById('header');
            const backBtn = document.getElementById('backBtn');
            const title = document.getElementById('pageTitle');

            if (viewId === 'view-login') {
                header.classList.add('hidden');
            } else {
                header.classList.remove('hidden');
                header.classList.add('flex');

                if (viewId === 'view-landing') {
                    backBtn.classList.add('hidden');
                    title.innerText = 'DASHBOARD';
                } else {
                    backBtn.classList.remove('hidden');
                    if (viewId === 'view-chat-interface') {
                        title.innerText = state.mode === 'insurance' ? 'APPLICATION' : 'ASSISTANT';
                    }
                    else if (viewId === 'view-details') title.innerText = 'PORTFOLIO';
                    else title.innerText = 'DETAILS';
                }
                updateUserHeader();
            }

            // Scroll to top
            document.querySelector('main').scrollTop = 0;
            setTimeout(() => lucide.createIcons(), 50);
        }

        function updateUserHeader() {
            if (state.user) {
                // Determine display name
                let displayName = state.user.first_name
                    ? `${state.user.first_name} ${state.user.last_name || ''}`.trim()
                    : (state.user.email ? state.user.email.split('@')[0] : 'Guest');

                // Truncate if too long
                if (displayName.length > 15) displayName = displayName.substring(0, 12) + '...';

                // Initial for circle
                const initial = displayName.charAt(0).toUpperCase();

                const nameEl = document.getElementById('header-username');
                const initEl = document.getElementById('header-initials');

                if (nameEl) nameEl.innerText = displayName;
                if (initEl) initEl.innerText = initial;
            }
        }

        function goBack() {
            if (state.mode !== 'none') {
                showAlert('confirm', 'Exit Session?', 'Exit current session? Progress may be lost.', (confirmed) => {
                    if (confirmed) {
                        state.mode = 'none';
                        showView('view-landing');
                    }
                });
            } else {
                showView('view-landing');
            }
        }

        function goToLanding() {
            state.mode = 'none';
            showView('view-landing');
        }

        function logout() {
            showAlert('confirm', t('logout_q'), t('logout_msg'), (confirmed) => {
                if (confirmed) {
                    localStorage.removeItem('access_token');
                    state.user = null;
                    resetLogin();
                    showView('view-login');
                }
            });
        }


        // --- LOGIN ---
        async function sendOTP() {
            const email = document.getElementById('emailInput').value;
            if (!email) {
                document.getElementById('emailInput').focus();
                return;
            }

            const btn = document.querySelector('button[onclick="sendOTP()"]');
            const originalText = btn.innerText;
            btn.innerText = t('sending');
            btn.disabled = true;

            const res = await apiCall('/auth/send-otp/', 'POST', { email });

            btn.innerText = originalText;
            btn.disabled = false;

            if (res.success) {
                document.getElementById('login-step-1').classList.add('hidden');
                document.getElementById('login-step-2').classList.remove('hidden');
                document.getElementById('login-step-2').classList.add('fade-in');
                // DEV TIP: Show OTP in alert or console for easier testing if returned
                if (res.otp) console.log("DEV OTP:", res.otp);
            } else {
                showAlert('error', t('login_failed_title'), res.message || 'Failed to send OTP');
            }
        }

        async function verifyOTP() {
            const email = document.getElementById('emailInput').value;
            const otp = document.getElementById('otpInput').value;

            if (!otp) {
                showAlert('warning', t('req_missing'), t('enter_otp'));
                return;
            }

            const btn = document.querySelector('button[onclick="verifyOTP()"]');
            const originalText = btn.innerText;
            btn.innerText = t('verifying');
            btn.disabled = true;

            const res = await apiCall('/auth/verify-otp/', 'POST', { email, otp_code: otp });

            btn.innerText = originalText;
            btn.disabled = false;

            if (res.success) {
                localStorage.setItem('access_token', res.access_token);
                state.user = res.user;
                showView('view-landing');
                fetchPolicies();
            } else {
                showAlert('error', 'Verification Failed', res.message || 'Invalid OTP');
            }
        }

        function resetLogin() {
            document.getElementById('login-step-2').classList.add('hidden');
            document.getElementById('login-step-1').classList.remove('hidden');
            document.getElementById('emailInput').value = '';
            document.getElementById('otpInput').value = '';
        }

        // --- CHAT SYSTEM ---

        async function clearChatSession() {
            showAlert('confirm', t('start_fresh_q'), t('start_fresh_msg'), async (confirmed) => {
                if (!confirmed) return;

                // Call backend to reset session
                const res = await apiCall('/insurance/applications/reset_session/', 'POST');

                if (res.success) {
                    // Clear Local State
                    state.chatHistory = [];
                    state.insuranceData = {};

                    // Clear UI
                    clearChatUI();

                    // Restart Flow
                    if (state.mode === 'insurance') {
                        initFlow();
                    } else if (state.mode === 'ai') {
                        openAskAI();
                    }
                } else {
                    showAlert('error', t('reset_failed'), t('reset_failed'));
                }
            });
        }

        function clearChatUI() {
            document.getElementById('chat-stream').innerHTML = '';
            document.getElementById('chat-options-container').innerHTML = '';
            document.getElementById('chat-options-container').classList.add('hidden');
        }

        function addChatBubble(content, sender = 'bot', isHtml = false, delay = 0) {
            const container = getCurrentStream();
            if (!container) return Promise.resolve();

            // 1. Add to local state history
            const msgObj = { content, sender, isHtml, timestamp: new Date().toISOString() };
            if (state.mode === 'ai') {
                state.aiChatHistory.push(msgObj);
            } else {
                state.chatHistory.push(msgObj);
            }

            // 2. Sync to backend if we have an active application
            if (state.mode === 'insurance' && state.insuranceData.applicationId && sender !== 'system') {
                syncChatHistory();
            }

            return new Promise(resolve => {
                setTimeout(() => {
                    // Only remove typing indicator when bot is responding
                    if (sender !== 'user') {
                        const existingTyping = container.querySelector('.typing-indicator-box');
                        if (existingTyping) existingTyping.remove();
                    }

                    const div = document.createElement('div');
                    div.className = `chat-bubble ${sender === 'user' ? 'chat-user' : 'chat-bot'} fade-in mb-4`;
                    if (isRTL() && sender === 'bot') {
                        div.style.direction = 'rtl';
                    }

                    if (isHtml) div.innerHTML = content;
                    else div.innerText = content;

                    container.appendChild(div);
                    div.scrollIntoView({ behavior: 'smooth', block: 'end' });
                    lucide.createIcons();
                    resolve();
                }, delay);
            });
        }

        async function syncChatHistory() {
            // Debounce or just send? For now just send.
            if (!state.insuranceData.applicationId) return;

            try {
                // We send the entire history or append? 
                // Django JSONField replaces by default. So we send full history.
                await apiCall(`/insurance/applications/${state.insuranceData.applicationId}/`, 'PATCH', {
                    chat_history: state.chatHistory
                });
            } catch (e) {
                console.error("Failed to sync chat", e);
            }
        }

        function renderChatHistoryFromState() {
            const container = document.getElementById('chat-stream');
            if (!container) return;

            container.innerHTML = ''; // Clear existing

            if (!Array.isArray(state.chatHistory)) {
                console.error("chatHistory is not an array:", state.chatHistory);
                state.chatHistory = [];
                return;
            }

            state.chatHistory.forEach(msg => {
                if (!msg || !msg.content) return;
                const div = document.createElement('div');
                div.className = `chat-bubble ${msg.sender === 'user' ? 'chat-user' : 'chat-bot'} fade-in mb-4`;
                if (isRTL() && msg.sender === 'bot') {
                    div.style.direction = 'rtl';
                }

                if (msg.isHtml) div.innerHTML = msg.content;
                else div.innerText = msg.content;
                container.appendChild(div);
            });

            // Scroll to bottom
            setTimeout(() => {
                if (container.lastChild) container.lastChild.scrollIntoView({ behavior: 'smooth' });
                lucide.createIcons();
            }, 100);
        }

        function showTyping() {
            const container = getCurrentStream();
            if (!container) return;

            // Remove existing one if any
            const existing = container.querySelector('.typing-indicator-box');
            if (existing) existing.remove();

            const div = document.createElement('div');
            // Premium glass style for the thinking indicator
            div.className = 'chat-bubble chat-bot fade-in mb-4 typing-indicator-box flex items-center justify-center py-3 px-5 border border-slate-100 shadow-soft';

            if (isRTL()) {
                div.style.direction = 'rtl';
            }

            // Universal Premium Animation (Gia)
            div.innerHTML = `
                <div class="flex items-center gap-3">
                    <div class="flex gap-1.5 relative">
                        <span class="w-2 h-2 bg-brand-500 rounded-full animate-bounce [animation-delay:-0.3s]"></span>
                        <span class="w-2 h-2 bg-brand-400 rounded-full animate-bounce [animation-delay:-0.15s]"></span>
                        <span class="w-2 h-2 bg-brand-300 rounded-full animate-bounce"></span>
                    </div>
                    <span class="text-[10px] font-bold text-slate-400 uppercase tracking-[0.15em] animate-pulse">${t('ai_thinking')}</span>
                </div>
            `;

            container.appendChild(div);
            div.scrollIntoView({ behavior: 'smooth', block: 'end' });
        }

        function setInputOptions(options, callbackName) {
            const container = document.getElementById('chat-options-container');
            container.innerHTML = '';
            container.classList.remove('hidden');

            options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'bg-white border border-slate-200 text-slate-700 py-3 px-6 rounded-full text-xs font-bold uppercase tracking-wider hover:bg-brand-500 hover:text-white hover:border-brand-500 transition-all shadow-sm active:scale-95 whitespace-nowrap';
                btn.innerText = opt.label;
                btn.onclick = () => window[callbackName](opt.value, opt.label);
                container.appendChild(btn);
            });

            const inputContainer = document.querySelector('.input-container-glass');
            inputContainer.scrollIntoView({ behavior: 'smooth' });
        }

        function hideInputOptions() {
            document.getElementById('chat-options-container').classList.add('hidden');
        }

        async function handleManualSend() {
            const val = document.getElementById('chatInput').value;
            if (!val) return;

            document.getElementById('chatInput').value = '';

            if (state.mode === 'insurance') {
                await addChatBubble(val, 'user');
                setTimeout(() => addChatBubble(t('restart_prompt'), 'bot'), 600);
            }
        }

        function handleAiManualSend() {
            const val = document.getElementById('aiChatInput').value;
            if (!val) return;

            document.getElementById('aiChatInput').value = '';

            if (state.mode === 'ai') {
                processAIQuery(val);
            }
        }

        // --- INSURANCE FLOW ---
        function startInsuranceFlow() {
            state.mode = 'insurance';

            // Allow user to see overview first? Or check active?
            // Let's check active silently.
            document.getElementById('modal-guidelines').classList.remove('hidden');
            document.body.classList.add('modal-open');
        }

        function closeGuidelines() {
            document.getElementById('modal-guidelines').classList.add('hidden');
            document.body.classList.remove('modal-open');
            showView('view-chat-interface');
            clearChatUI();

            // Check for previous session to resume
            checkForActiveSession();
        }

        async function checkForActiveSession() {
            showTyping();

            try {
                const res = await apiCall('/insurance/applications/active/');

                // Remove typing indicator once we get a response
                const typing = document.querySelector('.typing-indicator-box');
                if (typing) typing.remove();

                if (res.success && res.application) {
                    console.log("Restoring session:", res.application.id);

                    // 1. Map backend data to frontend state
                    state.insuranceData = {
                        ...res.application,
                        applicationId: res.application.id,
                        lang: res.application.language,
                        type: res.application.application_type,
                        salary: res.application.salary_range,
                        eid: res.application.emirates_id,
                        name: res.application.full_name
                    };

                    // 2. Parse Chat History safely
                    let history = res.application.chat_history;
                    if (typeof history === 'string') {
                        try { history = JSON.parse(history); } catch (e) { history = []; }
                    }
                    state.chatHistory = Array.isArray(history) ? history : [];

                    // 3. Render and Resume
                    if (state.chatHistory.length > 0) {
                        renderChatHistoryFromState();
                        // Add a resume greeting ONLY if it wasn't the last message
                        const lastMsg = state.chatHistory[state.chatHistory.length - 1];
                        if (!lastMsg.content.includes("Welcome back")) {
                            addChatBubble("Welcome back! I've restored your previous session.", 'bot');
                        }

                        // Wait a beat before jumping to UI logic to ensure chat is visible
                        setTimeout(() => resumeFlowLogic(), 500);
                    } else {
                        initFlow();
                    }
                } else {
                    // No active session found
                    initFlow();
                }
            } catch (err) {
                console.error("Session check failed:", err);
                const typing = document.querySelector('.typing-indicator-box');
                if (typing) typing.remove();
                initFlow();
            }
        }

        function resumeFlowLogic() {
            const d = state.insuranceData;

            // Determine where we are based on missing data
            if (!d.salary_range) {
                // If we have app but no salary (maybe created early? or bug)
                // Just restart flow questions but skip creating app again
                addChatBubble(t('continue_income'), 'bot');
                askIncome(false);
                return;
            }

            if (d.status === 'Pending OCR' || (d.status === 'In Progress' && d.emirates_id_document)) {
                // Document uploaded and waiting for review
                addChatBubble(t('review_details'), 'bot');
                setTimeout(() => {
                    document.getElementById('view-review').classList.remove('hidden');
                    document.body.classList.add('modal-open');
                    renderReviewForm();
                }, 1000);
                return;
            }

            if (!d.emirates_id_document) {
                // Needs upload
                askUpload();
                return;
            }

            // Fallback
            addChatBubble(t('restart_prompt'), 'bot');
        }

        async function initFlow() {
            state.insuranceData = {};
            state.chatHistory = []; // Reset local history

            showTyping();
            setTimeout(async () => {
                await addChatBubble(t('welcome'));
                showTyping();
                setTimeout(async () => {
                    await addChatBubble(t('select_lang'));
                    setInputOptions([
                        { label: 'English', value: 'en' },
                        { label: 'Malayalam', value: 'ml' },
                        { label: 'Arabic', value: 'ar' },
                        { label: 'Hindi', value: 'hi' },
                        { label: 'Urdu', value: 'ur' }
                    ], 'handleLanguage');
                }, 800);
            }, 600);
        }

        window.handleLanguage = async (val, label) => {
            await addChatBubble(label, 'user');
            hideInputOptions();
            state.insuranceData.lang = val;

            showTyping();
            setTimeout(async () => {
                await addChatBubble(t('looking_for_insurance'));
                setInputOptions([
                    { label: t('yes_start'), value: 'yes' },
                    { label: t('no_cancel'), value: 'no' }
                ], 'handleStartConfirm');
            }, 1000);
        };

        window.handleStartConfirm = async (val, label) => {
            await addChatBubble(label, 'user');
            hideInputOptions();

            if (val === 'no') {
                await addChatBubble(t('cancel_msg'), 'bot');
                setTimeout(() => goToLanding(), 2000);
                return;
            }

            showTyping();
            setTimeout(async () => {
                await addChatBubble(t('employee_or_dependent'));
                setInputOptions([
                    { label: t('employee'), value: 'Employee' },
                    { label: t('dependent'), value: 'Dependent' }
                ], 'handleType');
            }, 1000);
        }

        window.handleType = async (val, label) => {
            await addChatBubble(label, 'user');
            hideInputOptions();
            state.insuranceData.type = val;

            if (val === 'Employee') {
                askIncome();
            } else {
                askDependentType();
            }
        }

        function askIncome(isSponsor = false) {
            const txt = isSponsor ? t('income_sponsor') : t('income_self');
            showTyping();
            setTimeout(() => {
                addChatBubble(txt);
                setInputOptions([
                    { label: t('below_4000'), value: '<4000' },
                    { label: t('between_4000_5000'), value: '4000-5000' },
                    { label: t('above_5000'), value: '>5000' }
                ], 'handleIncome');
            }, 1000);
        }

        function askDependentType() {
            showTyping();
            setTimeout(async () => {
                await addChatBubble(t('dependent_type_q'));
                setInputOptions([
                    { label: t('spouse'), value: 'Spouse' },
                    { label: t('child'), value: 'Child' }
                ], 'handleDepType');
            }, 1000);
        }

        window.handleDepType = async (val, label) => {
            await addChatBubble(label, 'user');
            hideInputOptions();
            state.insuranceData.depType = val;
            askIncome(true);
        }

        window.handleIncome = async (val, label) => {
            await addChatBubble(label, 'user');
            hideInputOptions();
            state.insuranceData.salary = val;

            // Create Application on Backend here to start tracking
            createInitialApplication();
        }

        async function createInitialApplication() {
            showTyping();

            const appData = {
                language: state.insuranceData.lang,
                application_type: state.insuranceData.type,
                dependent_type: state.insuranceData.depType || '',
                salary_range: state.insuranceData.salary,
                // Partial data - dummy values for required fields that come later
                emirates_id: 'TEMP-' + Date.now(),
                full_name: 'Pending Upload',
                expiry_date: '2099-12-31',
                nationality: 'Pending',
                gender: 'Male',
                issuing_place: 'Pending',
                mobile_number: '0000000000',
                status: 'In Progress'
            };

            const res = await apiCall('/insurance/applications/', 'POST', appData);

            if (res.id) {
                state.insuranceData.applicationId = res.id;
                askUpload();
            } else {
                console.error("Failed to create app", res);
                askUpload(); // Continue anyway, will handle error later
            }
        }

        function askUpload() {
            const txt = state.insuranceData.type === 'Dependent' ? t('upload_sponsor') : t('upload_self');
            // Remove typing from previous step if any
            const existingTyping = document.querySelector('.typing-indicator-box');
            if (existingTyping) existingTyping.remove();

            addChatBubble(txt);

            const container = document.getElementById('chat-options-container');
            container.innerHTML = '';
            container.classList.remove('hidden');

            const btn = document.createElement('button');
            btn.className = 'w-full md:w-auto btn-gold text-white py-4 px-8 rounded-full text-sm font-bold uppercase tracking-wider flex items-center justify-center gap-3 shadow-lg transition-all active:scale-95';
            btn.innerHTML = `<i data-lucide="scan-line" class="w-5 h-5"></i> ${t('btn_upload')}`;
            btn.onclick = () => simulateUpload(); // Opens file picker

            container.appendChild(btn);
            lucide.createIcons();
            document.querySelector('.input-container-glass').scrollIntoView({ behavior: 'smooth' });
        }

        function simulateUpload() {
            // Create hidden file input
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*,application/pdf';

            input.onchange = async (e) => {
                const file = e.target.files[0];
                if (!file) return;

                addChatBubble(t('uploading'), 'user');
                hideInputOptions();
                showTyping();

                const formData = new FormData();
                formData.append('document', file);
                if (state.insuranceData.applicationId) {
                    formData.append('application_id', state.insuranceData.applicationId);
                }

                try {
                    const res = await apiCall('/insurance/process-ocr/', 'POST', formData, true);

                    if (res.success) {
                        state.insuranceData = {
                            ...state.insuranceData,
                            ...res.data,
                            eid: res.data.emirates_id, // Map backend keys to frontend state
                            name: res.data.full_name,
                            expiry: res.data.expiry_date,
                            issuingPlace: res.data.issuing_place
                        };

                        setTimeout(() => {
                            document.getElementById('view-review').classList.remove('hidden');
                            document.body.classList.add('modal-open');
                            renderReviewForm();
                        }, 500);
                    } else {
                        addChatBubble(t('upload_failed'), 'bot');
                    }

                } catch (err) {
                    addChatBubble(t('upload_error'), 'bot');
                }
            };

            input.click();
        }

        // --- OCR & REVIEW ---
        // processMockOCR removed - using backend

        function renderReviewForm() {
            const container = document.getElementById('review-form');
            const data = state.insuranceData;

            // Update UI Static elements
            document.getElementById('review-modal-subtitle').innerText = t('verification_title');
            document.getElementById('review-modal-title').innerText = t('review_details_title');
            document.getElementById('review-modal-badge').innerText = t('extracted_label');
            document.getElementById('review-modal-notice').innerHTML = `<i data-lucide="alert-triangle" class="w-4 h-4 flex-none"></i> ${t('verify_notice')}`;
            document.getElementById('review-modal-confirm').innerText = t('confirm_btn');
            document.getElementById('review-modal-cancel').innerText = t('close_btn');

            const createField = (key, label, type = 'text', readonly = false) => `
                <div class="group">
                    <label class="block text-[10px] font-bold text-slate-400 mb-2 uppercase tracking-wider group-focus-within:text-brand-500 transition-colors">${label}</label>
                    <input type="${type}" id="review-${key}" value="${data[key] || ''}" ${readonly ? 'readonly' : ''} 
                    class="w-full p-3.5 bg-slate-50 border border-slate-200 rounded-xl text-sm text-slate-800 font-semibold focus:border-brand-500 focus:ring-4 focus:ring-brand-500/10 focus:outline-none transition-all ${readonly ? 'bg-slate-100 text-slate-500 cursor-not-allowed' : ''}">
                </div>
            `;

            const createSelect = (key, label, options) => `
                 <div class="group">
                    <label class="block text-[10px] font-bold text-slate-400 mb-2 uppercase tracking-wider group-focus-within:text-brand-500 transition-colors">${label}</label>
                    <div class="relative">
                        <select id="review-${key}" class="w-full p-3.5 bg-slate-50 border border-slate-200 rounded-xl text-sm text-slate-800 font-semibold focus:border-brand-500 focus:ring-4 focus:ring-brand-500/10 focus:outline-none transition-all appearance-none">
                            ${options.map(o => `<option value="${o.value}" ${data[key] === o.value ? 'selected' : ''}>${o.label}</option>`).join('')}
                        </select>
                        <i data-lucide="chevron-down" class="absolute right-4 top-4 w-4 h-4 text-slate-400 pointer-events-none"></i>
                    </div>
                </div>
            `;

            container.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6" ${isRTL() ? 'dir="rtl"' : ''}>
                    ${createField('name', t('name'))}
                    ${createField('eid', t('eid_no'), 'text', true)}
                    
                    ${createField('date_of_birth', t('dob'), 'date')}
                    ${createField('nationality', t('nationality'))}
                    
                    ${createField('issuing_date', t('issuing_date'), 'date')}
                    ${createField('expiry', t('expiry_date'), 'date')}
                    
                    ${createSelect('issuingPlace', t('issuing_place'), [
                { label: 'Dubai', value: 'Dubai' },
                { label: 'Abu Dhabi', value: 'Abu Dhabi' },
                { label: 'Sharjah', value: 'Sharjah' },
                { label: 'Ajman', value: 'Ajman' },
                { label: 'Fujairah', value: 'Fujairah' },
                { label: 'Ras Al Khaimah', value: 'Ras Al Khaimah' },
                { label: 'Umm Al Quwain', value: 'Umm Al Quwain' }
            ])}
                    ${createSelect('gender', t('gender'), [
                { label: t('male'), value: 'Male' },
                { label: t('female'), value: 'Female' }
            ])}
                    
                    <div class="md:col-span-2">
                         ${createField('occupation', t('occupation'))}
                    </div>
                    
                    <div class="md:col-span-2">
                         ${createField('sponsor_name', t('sponsor'))}
                    </div>
                    
                    <div class="group md:col-span-2">
                         <label class="block text-[10px] font-bold text-slate-400 mb-2 uppercase tracking-wider group-focus-within:text-brand-500 transition-colors">${t('mobile_number_label')}</label>
                         <div class="flex">
                            <span class="p-3.5 bg-slate-100 border border-r-0 border-slate-200 rounded-l-xl text-sm font-semibold text-slate-500">+971</span>
                            <input type="tel" id="review-mobile" placeholder="50 123 4567" value="${data.mobile_number || ''}" class="w-full p-3.5 bg-slate-50 border border-slate-200 rounded-r-xl text-sm text-slate-800 font-semibold focus:border-brand-500 focus:border-l-slate-200 focus:ring-4 focus:ring-brand-500/10 focus:outline-none transition-all">
                        </div>
                    </div>
                </div>
            `;
            lucide.createIcons();
        }

        function cancelReview() {
            document.getElementById('view-review').classList.add('hidden');
            document.body.classList.remove('modal-open');
            addChatBubble("Review cancelled. Please re-upload.", 'bot');
            askUpload(); // Re-trigger upload flow
        }

        async function confirmReview() {
            // Harvest Data
            const data = state.insuranceData;

            // Map input values back to state
            data.name = document.getElementById('review-name').value;
            data.eid = document.getElementById('review-eid').value;
            data.date_of_birth = document.getElementById('review-date_of_birth').value;
            data.nationality = document.getElementById('review-nationality').value;
            data.issuing_date = document.getElementById('review-issuing_date').value;
            data.expiry = document.getElementById('review-expiry').value;

            data.issuingPlace = document.getElementById('review-issuingPlace').value;
            data.gender = document.getElementById('review-gender').value;

            data.occupation = document.getElementById('review-occupation').value;
            data.sponsor_name = document.getElementById('review-sponsor_name').value;
            data.mobile = document.getElementById('review-mobile').value;

            const expiryDate = new Date(data.expiry);
            const today = new Date();

            if (expiryDate < today) {
                showAlert('error', t('expired_doc_title'), t('expired_doc_msg'));
                return;
            }

            // Enhanced Validation per user request
            const requiredFields = ['name', 'eid', 'nationality', 'issuingPlace', 'expiry', 'gender', 'occupation', 'sponsor_name'];
            // Check for empty strings or null
            const missing = requiredFields.filter(f => !data[f] || (typeof data[f] === 'string' && data[f].trim() === ''));

            if (missing.length > 0) {
                showAlert('warning', t('missing_info'), t('req_missing'));
                return;
            }

            // Mobile Validation
            const cleanMobile = data.mobile.replace(/\D/g, ''); // Remove non-digits

            // Validation Rules:
            // 1. Must be 9 digits (after country code +971)
            // 2. Cannot be all zeros
            // 3. Must start with 5 (standard UAE mobile prefix)
            const isValidMobile = /^5\d{8}$/.test(cleanMobile) && !/^0+$/.test(cleanMobile);

            if (!isValidMobile) {
                showAlert('warning', t('missing_info'), "Please enter a valid 9-digit UAE mobile number starting with 5 (e.g., 501234567).");
                return;
            }

            // Close Modal
            document.getElementById('view-review').classList.add('hidden');
            document.body.classList.remove('modal-open');

            // Sync updated data to backend (Update application)
            if (data.applicationId) {
                const updateData = {
                    full_name: data.name,
                    date_of_birth: data.date_of_birth,
                    issuing_date: data.issuing_date,
                    expiry_date: data.expiry,
                    nationality: data.nationality,
                    issuing_place: data.issuingPlace,
                    gender: data.gender,
                    occupation: data.occupation,
                    sponsor_name: data.sponsor_name,
                    mobile_number: data.mobile,
                    status: 'Pending OCR' // Keep as pending until product selection or move to 'Under Review'
                };

                // We send PATCH to update the application with reviewed details
                try {
                    await apiCall(`/insurance/applications/${data.applicationId}/`, 'PATCH', updateData);
                } catch (e) {
                    console.error("Auto-save failed", e);
                }
            }

            // Resume Chat
            presentConfirmedDataInChat();
        }

        function presentConfirmedDataInChat() {
            const d = state.insuranceData;
            const html = `
                <div class="bg-white border border-slate-200 rounded-xl p-4 shadow-sm w-full md:min-w-[300px]" ${isRTL() ? 'dir="rtl"' : ''}>
                    <div class="flex items-center gap-2 mb-3 border-b border-slate-100 pb-2">
                        <i data-lucide="check-circle" class="w-4 h-4 text-green-500"></i>
                        <span class="text-xs font-bold text-slate-900 uppercase">${t('verified_details')}</span>
                    </div>
                    <div class="space-y-2 text-xs text-slate-600">
                        <div class="flex justify-between"><span>${t('name')}:</span> <span class="font-bold text-slate-800 text-right">${d.name}</span></div>
                        <div class="flex justify-between"><span>${t('eid')}:</span> <span class="font-mono text-slate-500 text-right">${d.eid}</span></div>
                        <div class="flex justify-between"><span>${t('dob')}:</span> <span class="text-right">${d.date_of_birth || '-'}</span></div>
                        <div class="flex justify-between"><span>${t('nationality')}:</span> <span class="text-right">${d.nationality || '-'}</span></div>
                        <div class="flex justify-between"><span>${t('gender')}:</span> <span class="text-right">${d.gender || '-'}</span></div>
                        <div class="flex justify-between"><span>${t('issuing_date')}:</span> <span class="text-right">${d.issuing_date || '-'}</span></div>
                        <div class="flex justify-between"><span>${t('expiry_date')}:</span> <span class="text-right">${d.expiry || '-'}</span></div>
                        <div class="flex justify-between"><span>${t('issuing_place')}:</span> <span class="text-right">${d.issuingPlace || '-'}</span></div>
                        <div class="flex justify-between"><span>${t('occupation')}:</span> <span class="text-right truncate max-w-[150px]">${d.occupation || '-'}</span></div>
                        <div class="flex justify-between"><span>${t('sponsor')}:</span> <span class="text-right truncate max-w-[150px]">${d.sponsor_name || '-'}</span></div>
                        <div class="flex justify-between"><span>${t('mobile')}:</span> <span class="text-right">${d.mobile || '-'}</span></div>
                        <div class="flex justify-between mt-2 pt-2 border-t border-slate-50 text-slate-800 font-bold"><span>${t('salary_range_label')}:</span> <span>${d.salary} AED</span></div>
                    </div>
                </div>
            `;

            addChatBubble(html, 'bot', true);
            setTimeout(() => lucide.createIcons(), 100);

            showTyping();
            setTimeout(() => {
                calculateAndShowProducts();
            }, 1500);
        }

        async function calculateAndShowProducts() {
            const place = state.insuranceData.issuingPlace;
            const salary = state.insuranceData.salary;

            // Backend Call for Recommendations
            const res = await apiCall('/insurance/recommendations/', 'POST', {
                salary_range: salary,
                issuing_place: place
            });

            if (res.success && res.products.length > 0) {
                const plans = res.products;

                await addChatBubble(t('found_plans', plans.length), 'bot');

                // Show Products in Chat Stream
                setTimeout(() => {
                    const container = document.getElementById('chat-stream');
                    const cardsContainer = document.createElement('div');
                    cardsContainer.className = 'flex flex-col md:flex-row gap-4 mt-2 fade-in mb-4 w-full md:w-auto';

                    plans.forEach((plan, index) => {
                        const card = document.createElement('div');
                        card.className = 'bg-white border border-slate-200 p-5 rounded-[20px] shadow-sm hover:shadow-md hover:border-brand-500 transition-all cursor-pointer flex-1 md:min-w-[260px] group';
                        // Map backend fields to frontend logic
                        const planData = {
                            name: plan.plan_name,
                            type: plan.plan_type,
                            price: plan.premium_amount
                        };
                        card.onclick = () => selectProduct(planData);

                        card.innerHTML = `
                            <div class="flex justify-between items-start mb-4" ${isRTL() ? 'dir="rtl"' : ''}>
                                <div class="${isRTL() ? 'text-right' : ''}">
                                    <h4 class="font-bold text-lg text-slate-800">${plan.plan_name}</h4>
                                    <span class="text-[10px] font-bold bg-slate-100 text-slate-500 px-2 py-1 rounded mt-1 inline-block group-hover:bg-brand-50 group-hover:text-brand-600 transition-colors">${plan.plan_type}</span>
                                </div>
                                <div class="w-8 h-8 rounded-full bg-slate-50 flex items-center justify-center group-hover:bg-brand-500 transition-colors">
                                    <i data-lucide="arrow-right" class="w-4 h-4 text-slate-400 group-hover:text-white ${isRTL() ? 'rotate-180' : ''}"></i>
                                </div>
                            </div>
                            <div class="text-2xl font-bold text-slate-900 mb-1 ${isRTL() ? 'text-right' : ''}"><span class="text-sm font-medium text-slate-400">AED</span> ${plan.premium_amount}</div>
                            <div class="text-[10px] text-green-600 font-bold uppercase tracking-wide flex items-center gap-1 ${isRTL() ? 'justify-end' : ''}">
                                <i data-lucide="check" class="w-3 h-3"></i> ${t('eligible')}
                            </div>
                        `;
                        cardsContainer.appendChild(card);
                    });

                    container.appendChild(cardsContainer);
                    lucide.createIcons();
                    cardsContainer.scrollIntoView({ behavior: 'smooth', block: 'end' });
                }, 800);
            } else {
                addChatBubble(t('no_plans'), 'bot');
                setTimeout(() => {
                    const btnHtml = `<button onclick="goToLanding()" class="text-xs text-brand-500 font-bold underline">${t('return_dashboard')}</button>`;
                    addChatBubble(btnHtml, 'bot', true);
                }, 1000);
            }
        }

        // Product Selection Logic
        async function selectProduct(plan) {
            await addChatBubble(t('select_plan_msg', plan.name, plan.type), 'user');
            showTyping();

            setTimeout(() => {
                finalizeInsurance(plan);
            }, 1000);
        }

        async function finalizeInsurance(plan) {
            // Call Backend Create Policy
            const payload = {
                application_id: state.insuranceData.applicationId,
                plan_name: plan.name,
                plan_type: plan.type,
                premium_amount: plan.price
            };

            const res = await apiCall('/insurance/create-policy/', 'POST', payload);

            if (res.success) {
                const policy = res.policy;

                // Success Card
                const successHtml = `
                    <div class="bg-gradient-to-br from-green-500 to-emerald-600 rounded-[24px] p-6 text-white shadow-lg w-full md:min-w-[320px]" ${isRTL() ? 'dir="rtl"' : ''}>
                        <div class="flex items-center gap-3 mb-4">
                            <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm">
                                <i data-lucide="check" class="w-6 h-6 text-white"></i>
                            </div>
                            <div class="${isRTL() ? 'text-right' : ''}">
                                <h3 class="font-bold text-lg">${t('success_title')}</h3>
                                <p class="text-xs text-white/80">${t('policy_active')}</p>
                            </div>
                        </div>
                        <div class="bg-white/10 rounded-xl p-4 backdrop-blur-sm mb-4">
                            <div class="flex justify-between text-sm mb-1"><span>${t('policy_no')}:</span> <span class="font-mono font-bold">${policy.policy_number}</span></div>
                            <div class="flex justify-between text-sm"><span>${t('premium')}:</span> <span class="font-bold">AED ${policy.premium_amount}</span></div>
                        </div>
                        <button onclick="window.location.href='http://google.com/'" class="w-full bg-white text-emerald-600 font-bold py-3 rounded-xl text-xs uppercase tracking-wider hover:bg-emerald-50 transition-colors">
                            ${t('continue_btn')}
                        </button>
                    </div>
                `;

                addChatBubble(successHtml, 'bot', true);
                setTimeout(() => lucide.createIcons(), 100);

                // Refresh policies
                fetchPolicies();
            } else {
                addChatBubble("Policy creation failed: " + res.message, 'bot');
            }
        }


        // --- ASK AI ---
        function openAskAI() {
            state.mode = 'ai';
            showView('view-ai-chat');

            // Set Placeholder
            document.getElementById('aiChatInput').placeholder = t('ai_placeholder');

            if (state.aiChatHistory.length === 0) {
                addChatBubble(t('ai_welcome_msg'));
            } else {
                renderAiChatHistoryFromState();
            }
        }

        function clearAiChatUI() {
            const stream = document.getElementById('ai-chat-stream');
            if (stream) stream.innerHTML = '';
        }

        function renderAiChatHistoryFromState() {
            const container = document.getElementById('ai-chat-stream');
            if (!container) return;

            container.innerHTML = '';
            state.aiChatHistory.forEach(msg => {
                const div = document.createElement('div');
                div.className = `chat-bubble ${msg.sender === 'user' ? 'chat-user' : 'chat-bot'} fade-in mb-4`;
                if (isRTL() && msg.sender === 'bot') div.style.direction = 'rtl';
                if (msg.isHtml) div.innerHTML = msg.content;
                else div.innerText = msg.content;
                container.appendChild(div);
            });

            setTimeout(() => {
                if (container.lastChild) container.lastChild.scrollIntoView({ behavior: 'smooth' });
                lucide.createIcons();
            }, 100);
        }

        async function processAIQuery(txt) {
            const container = document.getElementById('ai-chat-stream');
            await addChatBubble(txt, 'user');

            showTyping();

            const currentLang = state.insuranceData.lang || 'en';
            const apiKey = 'pk_9YXqUpDSFMMu9eXh';

            // Build Real-time Context
            const appStatus = state.insuranceData.status || 'Not started';
            const policyCount = state.policies.length;
            const userName = state.user ? state.user.full_name : 'Guest';

            const systemPrompt = `You are "Gia", the helpful and concise AI Guide for the Medical Insurance Portal.

                CONTEXT:
                - User: ${userName}
                - Status: ${appStatus}
                - Active Policies: ${policyCount}

                YOUR BEHAVIORAL RULES:
                1. **GREETING ETIQUETTE (CRITICAL):**
                - If the user says "Hey", "Hi", "Hello", or "Hy", simply reply with a friendly greeting and ask how you can help. 
                - **DO NOT** ask for salary or visa location until they specifically ask about insurance plans, prices, or starting an application.

                2. **LANGUAGE ADAPTABILITY:**
                - You are multilingual. If the user speaks a different language (e.g., Malayalam, Arabic) or asks to switch, **reply in that language immediately**.

                3. **DATA COLLECTION TRIGGER:**
                - Only ask "Where is your visa issued?" and "What is your salary?" IF the user asks for quotes, prices, or "which plan is for me?".

                4. **PRODUCT LOGIC (STRICT):**
                - **Dubai Visa:** * Salary < 4000: DHA Basic LSB (864 AED).
                    * Salary >= 4000: Choice of DHA Basic LSB (864 AED) OR DHA Basic NLSB (1893 AED).
                - **Abu Dhabi Visa:**
                    * Salary > 5000: DHA Basic NLSB (1893 AED).
                    * Salary <= 5000: No products available.

                5. **CONCISENESS:**
                - Keep replies short. If a user asks a question, answer it directly. Provide buttons only when a transition is natural (e.g., after explaining a process).

                SCOPE & SUPPORT:
                - **In Scope:** Insurance flows, family/dependent apps (select "Dependent" type), policy status.
                - **Out of Scope:** Non-insurance topics or technical bugs. 
                * For these: ğŸ“ 800-MED-HELP | ğŸ“§ support@medicalportal.ae

                ACTION BUTTONS:
                - Start App: [[BUTTON:${t('yes_start')}|action:flow]]
                - Dashboard: [[BUTTON:${t('return_dashboard')}|action:landing]]
                - Policies: [[BUTTON:${t('user_details_label')}|action:portfolio]]
            `;

            // Prep messages for Chat Completions (OpenAI style)
            const messages = [
                { role: "system", content: systemPrompt }
            ];

            // Add history (limit to last 10 for context window efficiency)
            const history = state.aiChatHistory.slice(-10).map(msg => ({
                role: msg.sender === 'user' ? 'user' : 'assistant',
                content: msg.content
            }));
            messages.push(...history);

            try {
                const response = await fetch(`https://gen.pollinations.ai/v1/chat/completions`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'openai-fast',
                        messages: messages,
                        seed: Math.floor(Math.random() * 1000)
                    })
                });

                if (!response.ok) throw new Error("API Connection Issue");

                const data = await response.json();
                const replyText = data.choices[0].message.content;

                // Parse and render
                const htmlResponse = parseAiResponse(replyText);
                addChatBubble(htmlResponse, 'bot', true);
            } catch (error) {
                console.error("AI Error:", error);
                const fallback = `I'm currently undergoing maintenance, but I can still help you start your journey: <br><br> [[BUTTON:${t('yes_start')}|action:flow]]`;
                addChatBubble(parseAiResponse(fallback), 'bot', true);
            }
        }

        function parseAiResponse(text) {
            // Bold markdown
            let html = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');

            // Bullet points (handle multi-line blocks)
            const lines = html.split('\n');
            let result = [];
            let inList = false;

            lines.forEach(line => {
                const trimmed = line.trim();
                if (trimmed.startsWith('- ') || trimmed.startsWith('* ')) {
                    if (!inList) {
                        result.push('<ul class="my-2 space-y-1">');
                        inList = true;
                    }
                    result.push(`<li class="ml-4 list-disc text-slate-600 font-medium text-xs md:text-sm">${trimmed.substring(2)}</li>`);
                } else {
                    if (inList) {
                        result.push('</ul>');
                        inList = false;
                    }
                    if (trimmed) result.push(`<div class="mb-1">${line}</div>`);
                    else result.push('<div class="h-2"></div>'); // Spacer for empty lines
                }
            });
            if (inList) result.push('</ul>');

            html = result.join('');

            // Parse Buttons: [[BUTTON:Label|Action]]
            html = html.replace(/\[\[BUTTON:(.*?)\|(.*?)\]\]/g, (match, label, action) => {
                let onclick = '';
                if (action === 'action:flow') onclick = 'startInsuranceFlow()';
                else if (action === 'action:landing') onclick = 'goToLanding()';
                else if (action === 'action:portfolio') onclick = 'showDetails()';

                return `
                    <button onclick="${onclick}" class="mt-3 w-full bg-brand-500 text-white py-3 px-4 rounded-xl text-xs font-bold uppercase tracking-wider hover:bg-brand-600 transition-all shadow-md active:scale-95 flex items-center justify-center gap-2">
                        ${label} <i data-lucide="arrow-right" class="w-4 h-4"></i>
                    </button>
                `;
            });

            return html;
        }

        // --- FETCH POLICIES ---
        async function fetchPolicies() {
            const res = await apiCall('/insurance/policies/active/');
            if (res.success && res.policies) {
                state.policies = res.policies; // array of policy objects
            }
        }

        // --- DETAILS ---
        function showDetails() {
            showView('view-details');
            const list = document.getElementById('policies-list');
            list.innerHTML = '';

            if (state.policies.length === 0) {
                document.getElementById('no-policies').classList.remove('hidden');
                return;
            } else {
                document.getElementById('no-policies').classList.add('hidden');
            }

            state.policies.forEach(p => {
                const card = document.createElement('div');
                card.className = 'bg-white p-6 md:p-8 rounded-[24px] shadow-sm border border-slate-100 flex flex-col md:flex-row md:items-center justify-between gap-4 hover:shadow-md hover:border-brand-300 transition-all cursor-pointer group';
                card.onclick = () => viewPolicyDetails(p.id);
                card.innerHTML = `
                    <div class="flex gap-4 items-start">
                        <div class="w-12 h-12 bg-blue-50 rounded-2xl flex items-center justify-center flex-none text-blue-600 group-hover:bg-brand-500 group-hover:text-white transition-colors">
                            <i data-lucide="shield" class="w-6 h-6"></i>
                        </div>
                        <div>
                            <div class="text-[10px] text-slate-400 font-bold font-mono uppercase tracking-widest mb-1 group-hover:text-brand-500 transition-colors">${p.policy_number}</div>
                            <h3 class="text-base font-bold text-slate-900">${p.plan_name} <span class="text-xs font-normal text-slate-500 bg-slate-100 px-2 py-0.5 rounded ml-2">${p.plan_type}</span></h3>
                            <p class="text-sm text-slate-500 mt-1 font-medium">Insured: ${p.insured_name}</p>
                        </div>
                    </div>
                    <div class="flex items-center justify-between md:flex-col md:items-end md:justify-center border-t md:border-0 border-slate-100 pt-4 md:pt-0">
                        <div class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-green-50 text-green-700 text-[10px] font-bold uppercase tracking-wide border border-green-100">
                            <div class="w-2 h-2 rounded-full bg-green-500"></div> ${p.status}
                        </div>
                        <div class="text-xs text-slate-400 mt-0 md:mt-2 font-medium flex items-center gap-2">
                            <span>${new Date(p.issue_date).toLocaleDateString()}</span>
                            <i data-lucide="chevron-right" class="w-4 h-4 text-slate-300 group-hover:translate-x-1 group-hover:text-brand-500 transition-all"></i>
                        </div>
                    </div>
                `;
                list.appendChild(card);
            });
            lucide.createIcons();
        }

        function viewPolicyDetails(policyId) {
            const policy = state.policies.find(p => p.id === policyId);
            if (!policy || !policy.application) return;

            const app = policy.application;
            const container = document.getElementById('policy-detail-container');

            // Update Titles
            document.getElementById('policy-detail-subtitle').innerText = t('policy_info_label');
            document.getElementById('policy-detail-title').innerText = t('user_details_label');
            document.querySelector('#view-policy-details button[onclick="closePolicyDetails()"]:last-child').innerText = t('close_btn');

            const createField = (label, value) => `
                <div class="group py-3 border-b border-slate-50 last:border-0">
                    <label class="block text-[10px] font-bold text-slate-400 mb-1 uppercase tracking-wider">${label}</label>
                    <div class="text-sm text-slate-800 font-semibold">${value || '-'}</div>
                </div>
            `;

            container.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2" ${isRTL() ? 'dir="rtl"' : ''}>
                    ${createField(t('name'), app.full_name)}
                    ${createField(t('eid'), app.emirates_id)}
                    
                    ${createField(t('dob'), app.date_of_birth)}
                    ${createField(t('nationality'), app.nationality)}
                    
                    ${createField(t('gender'), app.gender)}
                    ${createField(t('issuing_place'), app.issuing_place)}
                    
                    ${createField(t('issuing_date'), app.issuing_date)}
                    ${createField(t('expiry_date'), app.expiry_date)}
                    
                    <div class="md:col-span-2">
                        ${createField(t('occupation'), app.occupation)}
                    </div>
                    
                    <div class="md:col-span-2">
                        ${createField(t('sponsor'), app.sponsor_name)}
                    </div>

                    <div class="md:col-span-2">
                        ${createField(t('mobile'), app.mobile_number)}
                    </div>
                </div>
                
                <div class="mt-6 pt-6 border-t border-slate-100">
                    <div class="text-[10px] font-bold text-brand-500 uppercase tracking-[0.2em] mb-4">Official Record</div>
                    <div class="bg-slate-50 rounded-2xl p-4 flex items-center justify-between border border-slate-100">
                        <div>
                            <div class="text-[10px] text-slate-400 font-bold uppercase">Plan Type</div>
                            <div class="text-sm font-bold text-slate-800">${policy.plan_name} (${policy.plan_type})</div>
                        </div>
                        <div class="text-right">
                            <div class="text-[10px] text-slate-400 font-bold uppercase">Premium Paid</div>
                            <div class="text-sm font-bold text-brand-600">AED ${policy.premium_amount}</div>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('view-policy-details').classList.remove('hidden');
            document.body.classList.add('modal-open');
            lucide.createIcons();
        }

        function closePolicyDetails() {
            document.getElementById('view-policy-details').classList.add('hidden');
            document.body.classList.remove('modal-open');
        }

        // Check auth on load
        window.addEventListener('DOMContentLoaded', checkAuth);

        // Removed showView('view-login') here because checkAuth handles it
    </script>
</body>

</html>